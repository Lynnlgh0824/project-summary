<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“… é¡¹ç›®æ—¥å¿—ç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            min-height: 100vh;
            padding: 20px;
            position: relative;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* èƒŒæ™¯è£…é¥°åœ† */
        body::before {
            content: '';
            position: fixed;
            top: -10%;
            left: -10%;
            width: 50%;
            height: 50%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            border-radius: 50%;
            pointer-events: none;
        }

        body::after {
            content: '';
            position: fixed;
            bottom: -10%;
            right: -10%;
            width: 60%;
            height: 60%;
            background: radial-gradient(circle, rgba(255,255,255,0.08) 0%, transparent 70%);
            border-radius: 50%;
            pointer-events: none;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3), 0 0 0 1px rgba(255,255,255,0.3);
            overflow: hidden;
            position: relative;
            z-index: 1;
        }

        .header {
            background: linear-gradient(135deg, rgba(92, 124, 250, 0.95) 0%, rgba(116, 143, 252, 0.95) 100%);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            color: white;
            padding: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            z-index: 10;
        }

        .header h1 {
            font-size: 28px;
        }

        .header-controls {
            display: flex;
            gap: 15px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
        }

        .btn-primary {
            background: white;
            color: #5c7cfa;
        }

        .btn-primary:hover {
            background: #f0f0f0;
        }

        .btn-success {
            background: #4CAF50;
            color: white;
        }

        .btn-success:hover {
            background: #45a049;
        }

        .btn-quick-add {
            padding: 12px 24px;
            background: linear-gradient(135deg, #5c7cfa 0%, #748ffc 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(92, 124, 250, 0.4);
            transition: all 0.3s ease;
        }

        .btn-quick-add:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(92, 124, 250, 0.5);
            filter: brightness(1.1);
        }

        .btn-quick-add:active {
            transform: translateY(0);
        }

        .content {
            display: flex;
            height: calc(100vh - 140px);
        }

        .sidebar {
            width: 250px;
            background: #f8f9fa;
            border-right: 1px solid #dee2e6;
            padding: 20px;
            padding-top: 0;
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
        }

        .sidebar-header {
            padding: 20px 20px 10px 20px;
            background: #f8f9fa;
            position: sticky;
            top: 0;
            z-index: 50;
            flex-shrink: 0;
        }

        .sidebar-content {
            overflow-y: auto;
            flex: 1;
            padding: 0 20px 20px 20px;
        }

        .main {
            flex: 1;
            padding: 0 30px 30px 30px;
            overflow-y: auto;
            overflow-x: hidden;
        }

        /* æ ‡ç­¾é¡µå¯¼èˆªç²˜æ€§å®šä½ */
        .tab-navigation {
            position: sticky;
            top: 0;
            background: white;
            z-index: 100;
            padding: 10px 30px;
            margin: 0 -30px 20px -30px;
            border-bottom: 2px solid #dee2e6;
            min-height: 55px;
            display: flex;
            align-items: center;
        }

        .tab-navigation.fixed {
            position: sticky;
            top: 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .project-item {
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .project-item:hover {
            background: #e3f2fd;
        }

        .project-item.active {
            background: #5c7cfa;
            color: white;
        }

        .project-name {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .project-date {
            font-size: 12px;
            opacity: 0.7;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        thead {
            background: #f8f9fa;
        }

        th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: #333;
            border-bottom: 2px solid #dee2e6;
        }

        td {
            padding: 15px;
            border-bottom: 1px solid #dee2e6;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .project-name {
            font-weight: 600;
            color: #5c7cfa;
        }

        .log-date {
            color: #666;
            font-size: 14px;
        }

        .tag {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            margin: 0 5px 5px 0;
        }

        .tag-feature { background: #e3f2fd; color: #1565c0; }
        .tag-fix { background: #ffebee; color: #c62828; }
        .tag-improvement { background: #e8f5e9; color: #2e7d32; }
        .tag-learning { background: #fff3e0; color: #e65100; }

        .add-log-form {
            background: #f0f4ff;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            display: none;
        }

        .add-log-form.active {
            display: block;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }

        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        .form-control:focus {
            outline: none;
            border-color: #5c7cfa;
            box-shadow: 0 0 0 3px rgba(92, 124, 250, 0.1);
        }

        textarea.form-control {
            min-height: 100px;
            resize: vertical;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(400px);
                opacity: 0;
            }
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: #5c7cfa;
        }

        .stat-label {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }

        .log-summary {
            max-width: 500px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .log-summary.expanded {
            white-space: normal;
            max-width: none;
        }

        /* æ ‡ç­¾é¡µæ ·å¼ */
        .tab-btn {
            padding: 10px 20px;
            border: none;
            background: #f8f9fa;
            color: #666;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            border-radius: 6px 6px 0 0;
            transition: all 0.3s;
        }

        .tab-btn:hover {
            background: #e9ecef;
        }

        .tab-btn.active {
            background: #5c7cfa;
            color: white;
        }

        .tab-content {
            display: block;
            margin-top: 20px;
        }

        /* é“¾æ¥å¡ç‰‡æ ·å¼ */
        .link-card {
            display: block;
            padding: 14px 16px;
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 8px;
            text-decoration: none;
            color: #333;
            font-size: 14px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .link-card:hover {
            border-color: rgba(92, 124, 250, 0.4);
            box-shadow: 0 4px 12px rgba(92,124,250,0.2);
            transform: translateY(-2px);
            background: rgba(255, 255, 255, 0.85);
        }

        .link-card-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
        }

        .link-card-path {
            font-size: 12px;
            color: #666;
            word-break: break-all;
        }

        .empty-state-enhanced {
            text-align: center;
            padding: 50px 20px;
            background: rgba(245, 247, 250, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 12px;
            border: 2px dashed rgba(222, 226, 230, 0.5);
        }

        .empty-state-enhanced .emoji {
            font-size: 56px;
            margin-bottom: 16px;
            opacity: 0.6;
        }

        .empty-state-enhanced .message {
            color: #666;
            font-size: 16px;
            margin-bottom: 8px;
        }

        .empty-state-enhanced .hint {
            color: #999;
            font-size: 13px;
        }

        .project-section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin: 25px 0 15px;
            padding: 12px 16px;
            background: linear-gradient(135deg, rgba(92, 124, 250, 0.95) 0%, rgba(116, 143, 252, 0.95) 100%);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .project-section-header:hover {
            transform: translateX(5px);
            box-shadow: 0 8px 24px rgba(92,124,250,0.35);
        }

        .project-section-header .index {
            font-size: 18px;
            font-weight: 700;
            margin-right: 12px;
            opacity: 0.9;
        }

        .project-section-header .name {
            font-size: 16px;
            font-weight: 600;
        }

        .project-section-header .hint {
            font-size: 12px;
            opacity: 0.8;
        }

        .links-container {
            display: grid;
            gap: 10px;
            padding: 20px;
            background: rgba(240, 244, 255, 0.5);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 12px;
            border: 1px solid rgba(222, 226, 230, 0.5);
        }

        .no-content-message {
            text-align: center;
            padding: 30px;
            color: #999;
            font-size: 14px;
            background: white;
            border-radius: 8px;
            border: 1px dashed #dee2e6;
        }

        /* åˆ†ç±»æ ‡é¢˜æ ·å¼ */
        .category-header {
            display: flex;
            align-items: center;
            margin: 20px 0 12px;
            padding: 12px 16px;
            background: rgba(248, 249, 250, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 10px;
            border-left: 5px solid #5c7cfa;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            transition: all 0.3s ease;
        }

        .category-header:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transform: translateX(3px);
        }

        .category-header .icon {
            font-size: 24px;
            margin-right: 12px;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
        }

        .category-header .title {
            font-weight: 700;
            color: #222;
            font-size: 16px;
            flex: 1;
            letter-spacing: 0.3px;
        }

        .category-header .desc {
            font-size: 13px;
            color: #888;
            margin-right: 10px;
            font-weight: 400;
        }

        .category-header .count {
            font-size: 13px;
            font-weight: 600;
            color: #5c7cfa;
            background: rgba(227, 244, 255, 0.7);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            padding: 5px 12px;
            border-radius: 16px;
            border: 1px solid rgba(184, 228, 255, 0.5);
        }

        .link-card-docs { border-left: 3px solid #5c7cfa; }
        .link-card-tools { border-left: 3px solid #ff9800; }
        .link-card-learning { border-left: 3px solid #4caf50; }
        .link-card-paths { border-left: 3px solid #9c27b0; }

        /* å¾…åŠæ¸…å•æ ·å¼ */
        .todo-project-card {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .todo-project-card:hover {
            box-shadow: 0 12px 48px rgba(92, 124, 250, 0.15);
            transform: translateY(-2px);
        }

        .todo-project-header {
            background: linear-gradient(135deg, rgba(92, 124, 250, 0.95) 0%, rgba(116, 143, 252, 0.95) 100%);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            color: white;
            padding: 16px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .todo-project-header:hover {
            filter: brightness(1.05);
        }

        .todo-project-header h3 {
            margin: 0;
            font-size: 18px;
            font-weight: 600;
        }

        .todo-project-stats {
            display: flex;
            gap: 15px;
            font-size: 13px;
            opacity: 0.9;
        }

        .todo-project-stats span {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .todo-list {
            padding: 15px 20px;
        }

        .todo-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 8px;
            background: rgba(248, 249, 250, 0.6);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .todo-item:hover {
            background: rgba(233, 236, 239, 0.8);
            transform: translateX(3px);
            box-shadow: 0 4px 12px rgba(92, 124, 250, 0.1);
        }

        .todo-item.completed {
            opacity: 0.6;
        }

        .todo-item.completed .todo-text {
            text-decoration: line-through;
            color: #999;
        }

        .todo-checkbox {
            width: 20px;
            height: 20px;
            cursor: pointer;
            flex-shrink: 0;
        }

        .todo-content {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .todo-text {
            flex: 1;
            font-size: 14px;
        }

        .todo-priority {
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 11px;
            font-weight: 600;
            flex-shrink: 0;
        }

        .todo-priority.high {
            background: #ffebee;
            color: #c62828;
        }

        .todo-priority.medium {
            background: #fff3e0;
            color: #e65100;
        }

        .todo-priority.low {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .todo-due-date {
            font-size: 12px;
            color: #666;
            flex-shrink: 0;
        }

        .todo-due-date.overdue {
            color: #c62828;
            font-weight: 600;
        }

        .todo-actions {
            display: flex;
            gap: 8px;
        }

        .todo-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            padding: 4px 8px;
            border-radius: 4px;
            transition: all 0.2s;
            opacity: 0.6;
        }

        .todo-item:hover .todo-btn {
            opacity: 1;
        }

        .todo-btn:hover {
            background: #e0e0e0;
        }

        .todo-btn-delete:hover {
            background: #ffebee;
            color: #c62828;
        }

        .add-todo-form {
            display: flex;
            gap: 10px;
            padding: 15px 20px;
            background: #f0f4ff;
            border-top: 1px solid #dee2e6;
        }

        .add-todo-form input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }

        .add-todo-form select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            background: white;
        }

        .add-todo-form button {
            padding: 8px 16px;
            background: #5c7cfa;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .add-todo-form button:hover {
            background: #4263eb;
        }

        .empty-todos {
            text-align: center;
            padding: 40px 20px;
            color: #999;
            background: rgba(248, 249, 250, 0.6);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 8px;
            border: 2px dashed rgba(222, 226, 230, 0.5);
        }

        .empty-todos .emoji {
            font-size: 48px;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div>
                <h1>ğŸ“… é¡¹ç›®æ—¥å¿—ç³»ç»Ÿ</h1>
                <p style="font-size: 14px; opacity: 0.9; margin-top: 5px;">
                    æŒ‰é¡¹ç›®ã€æ—¥æœŸè®°å½•å·¥ä½œæ€»ç»“ï¼Œè‡ªåŠ¨ç”Ÿæˆæ—¥æŠ¥
                </p>
            </div>
            <div class="header-controls">
                <button class="btn btn-success" onclick="refreshAllData()">ğŸ”„ åˆ·æ–°æ•°æ®</button>
                <button class="btn btn-primary" onclick="autoGenerateTodayLog()">ğŸ¤– æ™ºèƒ½ç”Ÿæˆ</button>
                <button class="btn btn-primary" onclick="showAddForm()">â• æ·»åŠ æ—¥å¿—</button>
            </div>
        </div>

        <div class="content">
            <!-- ä¾§è¾¹æ ï¼šé¡¹ç›®åˆ—è¡¨ -->
            <div class="sidebar">
                <!-- ä¾§è¾¹æ å¤´éƒ¨ - å›ºå®š -->
                <div class="sidebar-header">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <h3 style="margin: 0; color: #333;">ğŸ“ é¡¹ç›®åˆ—è¡¨</h3>
                        <button class="btn btn-primary" onclick="showAddProjectForm()" style="padding: 5px 10px; font-size: 12px;">â•</button>
                    </div>
                </div>

                <!-- ä¾§è¾¹æ å†…å®¹ - å¯æ»šåŠ¨ -->
                <div class="sidebar-content">
                    <!-- æ·»åŠ é¡¹ç›®è¡¨å• -->
                    <div id="addProjectForm" style="display: none; background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <input type="text" id="newProjectName" class="form-control" placeholder="é¡¹ç›®åç§°" style="margin-bottom: 10px;">
                        <button class="btn btn-success" onclick="addNewProject()" style="width: 100%; font-size: 12px;">ä¿å­˜</button>
                        <button class="btn btn-primary" onclick="hideAddProjectForm()" style="width: 100%; margin-top: 5px; font-size: 12px;">å–æ¶ˆ</button>
                    </div>

                    <div id="projectList"></div>

                    <!-- é¡¹ç›®ç»Ÿè®¡ -->
                    <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #dee2e6;">
                        <h4 style="margin-bottom: 15px; font-size: 14px; color: #666;">ğŸ“Š é¡¹ç›®ç»Ÿè®¡</h4>
                        <div id="projectStats"></div>
                    </div>
                </div>
            </div>

            <!-- ä¸»å†…å®¹åŒº -->
            <div class="main">
                <!-- æ ‡ç­¾é¡µå¯¼èˆª - ç²˜æ€§å®šä½ -->
                <div class="tab-navigation">
                    <div style="display: flex; gap: 10px; margin-bottom: 0;">
                        <button class="tab-btn active" onclick="switchTab('todos')">âœ… å¾…åŠæ¸…å•</button>
                        <button class="tab-btn" onclick="switchTab('logs')">ğŸ“… å·¥ä½œæ—¥å¿—</button>
                        <button class="tab-btn" onclick="switchTab('summary')">ğŸ“š é¡¹ç›®ç»éªŒæ€»ç»“</button>
                        <button class="tab-btn" onclick="switchTab('links')">ğŸ”— é¡¹ç›®é“¾æ¥æ±‡æ€»</button>
                        <button class="tab-btn" onclick="switchTab('check')">ğŸ” é¡¹ç›®æ£€æŸ¥</button>
                    </div>
                </div>

                <!-- æ ‡ç­¾é¡µ1: å¾…åŠæ¸…å• -->
                <div id="tab-todos" class="tab-content">
                <div id="todosContent"></div>
            </div>

            <!-- æ ‡ç­¾é¡µ2: å·¥ä½œæ—¥å¿— -->
            <div id="tab-logs" class="tab-content" style="display: none;">
                <!-- ç»Ÿè®¡å¡ç‰‡ -->
                <div class="stats" id="stats"></div>

                <!-- æ·»åŠ è¡¨å• -->
                <div class="add-log-form" id="addForm">
                <h2 style="margin-bottom: 20px;">â• æ·»åŠ é¡¹ç›®æ—¥å¿—</h2>
                <div class="form-group">
                    <label>é¡¹ç›®åç§° *</label>
                    <select id="projectSelect" class="form-control">
                        <option value="english-learning-tts">è‹±è¯­å­¦ä¹  TTS ç³»ç»Ÿ</option>
                        <option value="data-analysis">æ•°æ®åˆ†æé¡¹ç›®</option>
                        <option value="other">å…¶ä»–é¡¹ç›®</option>
                    </select>
                </div>

                <div class="form-group" id="otherProjectGroup" style="display: none;">
                    <label>å…¶ä»–é¡¹ç›®åç§° *</label>
                    <input type="text" id="otherProjectName" class="form-control" placeholder="è¾“å…¥é¡¹ç›®åç§°">
                </div>

                <div class="form-group">
                    <label>æ—¥æœŸ *</label>
                    <input type="date" id="logDate" class="form-control" value="">
                </div>

                <div class="form-group">
                    <label>ç±»å‹</label>
                    <select id="logType" class="form-control">
                        <option value="feature">âœ¨ æ–°åŠŸèƒ½</option>
                        <option value="fix">ğŸ”§ ä¿®å¤ Bug</option>
                        <option value="improvement">ğŸš€ ä¼˜åŒ–æ”¹è¿›</option>
                        <option value="learning">ğŸ“š å­¦ä¹ æ€»ç»“</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>é¡¹ç›®æ€»ç»“æ—¥å¿—ï¼ˆæ¯è¡Œä¸€é¡¹ï¼‰ *</label>
                    <textarea id="logItems" class="form-control" placeholder="âœ… ä¿®å¤ TTS é˜Ÿåˆ—ç­–ç•¥é—®é¢˜&#10;âœ… åˆ›å»ºé¡¹ç›®æ—¥å¿—ç³»ç»Ÿ&#10;âœ… æ·»åŠ æ¡Œé¢å¿«æ·æ–¹å¼"></textarea>
                </div>

                <div class="form-group">
                    <label>ä»£ç ç‰‡æ®µï¼ˆå¯é€‰ï¼‰</label>
                    <textarea id="logCode" class="form-control" placeholder="ç²˜è´´ç›¸å…³ä»£ç ..."></textarea>
                </div>

                <button class="btn btn-success" onclick="saveLogForm()">ğŸ’¾ ä¿å­˜æ—¥å¿—</button>
                <button class="btn btn-primary" onclick="hideAddForm()">âŒ å–æ¶ˆ</button>
            </div>

            <!-- æ—¥å¿—åˆ—è¡¨ -->
            <div id="logTable"></div>
            </div>

            <!-- æ ‡ç­¾é¡µ3: é¡¹ç›®ç»éªŒæ€»ç»“ -->
            <div id="tab-summary" class="tab-content" style="display: none;">
                <div id="summaryContent"></div>
            </div>

            <!-- æ ‡ç­¾é¡µ4: é¡¹ç›®é“¾æ¥æ±‡æ€» -->
            <div id="tab-links" class="tab-content" style="display: none;">
                <div id="linksContent"></div>
            </div>

            <!-- æ ‡ç­¾é¡µ5: é¡¹ç›®æ£€æŸ¥ -->
            <div id="tab-check" class="tab-content" style="display: none;">
                <div style="padding: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h2>ğŸ” é¡¹ç›®æ–‡ä»¶æ£€æŸ¥</h2>
                        <button class="btn btn-primary" onclick="runProjectCheck()">â–¶ï¸ è¿è¡Œæ£€æŸ¥</button>
                    </div>
                    <div id="checkResults" style="margin-top: 20px;">
                        <div style="text-align: center; padding: 40px; color: #999;">
                            <p>ç‚¹å‡»"è¿è¡Œæ£€æŸ¥"æŒ‰é’®å¼€å§‹æ£€æŸ¥é¡¹ç›®æ–‡ä»¶</p>
                        </div>
                    </div>
                </div>
            </div>
            </div>
        </div>
    </div>

    <script>
        const STORAGE_KEY = 'project_logs';
        const PROJECTS_KEY = 'project_list';
        const TODOS_KEY = 'project_todos';
        let fileHandle = null; // æ–‡ä»¶å¥æŸ„ï¼Œç”¨äºè‡ªåŠ¨ä¿å­˜

        const defaultProjects = [
            { id: 'project-organization', name: 'ğŸ—‚ï¸ é¡¹ç›®ç»„ç»‡ä¸ç®¡ç†', startDate: '2026-02-06' },
            { id: 'english-learning-tts', name: 'ğŸ§ è‹±è¯­å­¦ä¹ ', startDate: '2026-02-05' },
            { id: 'chiang-mai-activities', name: 'ğŸï¸ æ¸…è¿ˆæ´»åŠ¨æ¢ç´¢', startDate: '2026-01-19' },
            { id: 'aisaas-video', name: 'ğŸ¥ AI SaaS è§†é¢‘é¡¹ç›®', startDate: '2026-01-22' },
            { id: 'clawdbot-railway', name: 'ğŸ¤– Clawdbot', startDate: '2026-01-15' },
            { id: 'skills-development', name: 'âš¡ æŠ€èƒ½å¼€å‘ä¸å­¦ä¹ ', startDate: '2026-01-01' }
        ];

                // é¡¹ç›®æ•°æ®
        const projectData = {
            'project-organization': {
                summary: {
                    title: 'ğŸ—‚ï¸ é¡¹ç›®ç»„ç»‡ä¸ç®¡ç†',
                    description: 'é¡¹ç›®ç»“æ„ä¼˜åŒ–ã€æ–‡ä»¶ç®¡ç†ã€æ¡Œé¢å¿«æ·æ–¹å¼é…ç½®',
                    achievements: [
                        'âœ… æ¸…ç†é¡¹ç›®ç›®å½• - å½’æ¡£æ—§æ–‡ä»¶',
                        'âœ… é‡ç»„é¡¹ç›®ç»“æ„ - åˆ›å»º project summary ç›®å½•',
                        'âœ… ä¿®å¤æ¡Œé¢å¿«æ·æ–¹å¼',
                        'âœ… ä¼˜åŒ–é¡¹ç›®æ—¥å¿—ç³»ç»Ÿ'
                    ],
                    docs: []
                },
                folder: '/Users/yuzhoudeshengyin/Documents/my_project/project summary/'
            },
            'english-learning-tts': {
                summary: {
                    title: 'ğŸ§ è‹±è¯­å­¦ä¹  TTS ç³»ç»Ÿ',
                    description: 'Web Speech APIå®ç°çš„æ™ºèƒ½æœ—è¯»ç³»ç»Ÿï¼Œæ”¯æŒè¯­é€Ÿè°ƒèŠ‚ã€å¥å­åœé¡¿ã€‚åŒ…å«YouTubeè§†é¢‘å­¦ä¹ å†…å®¹ã€‚',
                    achievements: [
                        'âœ… å®ç°å¥å­é—´1ç§’åœé¡¿ - é€’å½’æ’­æ”¾ + setTimeout',
                        'âœ… è¯­é€Ÿè®¾ç½® - å¿«é€Ÿ1.0xã€æ ‡å‡†0.5xã€ç¼“æ…¢0.25x',
                        'âœ… ä»£ç ä¼˜åŒ– - åˆ é™¤903è¡Œé‡å¤ä»£ç ',
                        'âœ… UIä¼˜åŒ– - ç²˜æ€§å¯¼èˆªã€å“åº”å¼å¸ƒå±€',
                        'âœ… YouTubeè§†é¢‘å­¦ä¹  - åˆ›ä¸šã€ä¸Šæµ·é‡æ–°å¼€å§‹ã€å›å®¶ä¹‹è·¯ã€æ¸…è¿ˆç‹¬å±…'
                    ],
                    docs: [
                        // ğŸ“š æ–‡æ¡£èµ„æ–™
                        { name: 'ğŸ“– é¡¹ç›®è¯´æ˜', url: '/Users/yuzhoudeshengyin/Documents/my_project/english-learning/README.md', category: 'docs' },
                        { name: 'ğŸ“‹ æµ‹è¯•å·¥å…·æŒ‡å—', url: '/Users/yuzhoudeshengyin/Documents/my_project/english-learning/docs/TEST-TOOLS.md', category: 'docs' },
                        { name: 'ğŸ”§ TTSæµ‹è¯•è¯´æ˜', url: '/Users/yuzhoudeshengyin/Documents/my_project/english-learning/docs/TTS-TEST.md', category: 'docs' },
                        { name: 'ğŸ§¹ æµ‹è¯•å·¥å…·æ¸…ç†æ–¹æ¡ˆ', url: '/Users/yuzhoudeshengyin/Documents/my_project/english-learning/docs/TEST-TOOLS-CLEANUP.md', category: 'docs' },
                        { name: 'ğŸ”— å®Œæ•´é“¾æ¥æ±‡æ€»', url: '/Users/yuzhoudeshengyin/Documents/my_project/english-learning/ALL-LINKS.md', category: 'docs' },
                        { name: 'ğŸš¨ TTS Canceledé”™è¯¯ä¿®å¤', url: '/Users/yuzhoudeshengyin/Documents/my_project/english-learning/docs/TTS-CANCELED-FIX-2026-02-24.md', category: 'docs' },
                        { name: 'ğŸ§Ÿ TTSåƒµå°¸çŠ¶æ€è§£å†³æ–¹æ¡ˆ', url: '/Users/yuzhoudeshengyin/Documents/my_project/english-learning/docs/TTS-ZOMBIE-STATE-SOLUTION.md', category: 'docs' },
                        // ğŸ› ï¸ æµ‹è¯•ä¸ç»´æŠ¤
                        { name: 'ğŸ§ª æµ‹è¯•ä¸ç»´æŠ¤ä¸­å¿ƒ', url: 'http://localhost:8001/test-hub.html', category: 'test' },
                        { name: 'ğŸš€ ç®€å•è‡ªåŠ¨æµ‹è¯•', url: '/Users/yuzhoudeshengyin/Documents/my_project/english-learning/simple-auto-test.html', category: 'test' },
                        { name: 'ğŸ”§ TTSå¼•æ“æ¢å¤å·¥å…·', url: '/Users/yuzhoudeshengyin/Documents/my_project/english-learning/tts-engine-recovery.html', category: 'test' },
                        { name: 'ğŸ§ª è‡ªåŠ¨åŒ–æµ‹è¯•å¥—ä»¶', url: '/Users/yuzhoudeshengyin/Documents/my_project/english-learning/archives/test-files/auto-test-runner.html', category: 'test' },
                        { name: 'ğŸ¯ æœ€ç»ˆåŠŸèƒ½éªŒè¯', url: '/Users/yuzhoudeshengyin/Documents/my_project/english-learning/archives/test-files/test-final-validation.html', category: 'test' },
                        { name: 'ğŸ› TTSè°ƒè¯•å·¥å…·', url: '/Users/yuzhoudeshengyin/Documents/my_project/english-learning/archives/test-files/test-debug.html', category: 'test' },
                        { name: 'ğŸ”Š éŸ³é¢‘è¾“å‡ºæµ‹è¯•', url: '/Users/yuzhoudeshengyin/Documents/my_project/english-learning/archives/test-files/test-audio-output.html', category: 'test' },
                        { name: 'ğŸ‘† ç”¨æˆ·æ‰‹åŠ¿æµ‹è¯•', url: '/Users/yuzhoudeshengyin/Documents/my_project/english-learning/archives/test-files/test-user-gesture.html', category: 'test' },
                        { name: 'ğŸ“ è‡ªåŠ¨æ—¥å¿—æ•è·', url: '/Users/yuzhoudeshengyin/Documents/my_project/english-learning/archives/test-files/auto-log-capture.html', category: 'test' },
                        { name: 'ğŸ” TTSè¯Šæ–­å·¥å…·', url: '/Users/yuzhoudeshengyin/Documents/my_project/english-learning/archives/test-files/auto-diagnose.html', category: 'test' },
                        // ğŸ”§ æ ¸å¿ƒè„šæœ¬
                        { name: 'ğŸ”Š TTSæ ¸å¿ƒåŠŸèƒ½', url: '/Users/yuzhoudeshengyin/Documents/my_project/english-learning/scripts/tts-common.js', category: 'script' },
                        { name: 'ğŸ“„ é¡µé¢å…¬å…±åŠŸèƒ½', url: '/Users/yuzhoudeshengyin/Documents/my_project/english-learning/scripts/page-common.js', category: 'script' }
                    ]
                },
                folder: '/Users/yuzhoudeshengyin/Documents/my_project/english-learning/'
            },
            'aisaas-video': {
                summary: {
                    title: 'ğŸ¥ AI SaaS è§†é¢‘é¡¹ç›®',
                    description: 'AIè§†é¢‘ç”Ÿæˆå·¥å…·å’Œå¥—å£³ç«™ç ”ç©¶',
                    achievements: [
                        'âœ… æ”¶é›†AIè§†é¢‘å¥—å£³ç«™ç›¸å…³èµ„æ–™',
                        'âœ… ç ”ç©¶è§†é¢‘SaaSç«™ç¬¬äºŒæ¬¡ç›´æ’­å†…å®¹',
                        'âœ… åˆ†æAIè§†é¢‘ç”Ÿæˆå·¥å…·å¸‚åœº'
                    ],
                    docs: [
                        { name: 'ğŸ¬ AIè§†é¢‘å·¥å…·ç ”ç©¶', url: 'https://www.synthesia.io/', category: 'learning' },
                        { name: 'ğŸ¤– HeyGen è§†é¢‘ç”Ÿæˆ', url: 'https://www.heygen.com/', category: 'learning' },
                        { name: 'ğŸ“º SaaSäº§å“æ¡ˆä¾‹', url: 'https://www.producthunt.com/', category: 'learning' }
                    ]
                },
                folder: '/Users/yuzhoudeshengyin/Desktop/AIç›¸å…³é¡¹ç›®/' },
            'clawdbot-railway': {
                summary: {
                    title: 'ğŸ¤– Clawdbot Railway æ¨¡æ¿',
                    description: 'Discord Bot éƒ¨ç½²æ¨¡æ¿å’Œ Railway å¹³å°é…ç½®',
                    achievements: [
                        'âœ… ç ”ç©¶ Railway å¹³å°éƒ¨ç½²',
                        'âœ… é…ç½® Clawdbot æ¨¡æ¿',
                        'âœ… æµ‹è¯• Discord Bot åŠŸèƒ½'
                    ],
                    docs: []
                },
                folder: '/Users/yuzhoudeshengyin/Desktop/',
                projectFolder: '/Users/yuzhoudeshengyin/Documents/my_project/clawdbot-railway/'
            },
            'chiang-mai-activities': {
                summary: {
                    title: 'ğŸï¸ æ¸…è¿ˆæ´»åŠ¨ç­–åˆ’',
                    description: 'æ´»åŠ¨ç®¡ç†ç³»ç»Ÿ - æ•°æ®è´¨é‡ã€è‡ªåŠ¨åŒ–æµ‹è¯•',
                    achievements: [
                        'âœ… å®ç°æ´»åŠ¨æ•°æ®ç®¡ç†ç³»ç»Ÿ',
                        'âœ… GitHub Actions è‡ªåŠ¨åŒ–æ•°æ®è´¨é‡æ£€æŸ¥',
                        'âœ… è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶',
                        'âœ… æ™ºèƒ½æè¿°ä¿®å¤å·¥å…·',
                        'âœ… æ¨é€åˆ° GitHub (20ä¸ªæ–‡ä»¶, +13,227è¡Œ)'
                    ],
                    docs: [
                        { name: 'ğŸŒ ä¸»é¡µé¢', url: 'http://localhost:8001/public/', category: 'tools' },
                        { name: 'ğŸ”§ ç®¡ç†åå°', url: 'http://localhost:8001/public/admin.html', category: 'tools' },
                        { name: 'ğŸ“¦ å½’æ¡£æŸ¥çœ‹', url: 'http://localhost:8001/public/archive-view.html', category: 'tools' },
                        { name: 'ğŸ“Š GitHub ä»“åº“', url: 'https://github.com/Lynnlgh0824/chiengmai-activities', category: 'docs' },
                        { name: 'ğŸ“– README æ–‡æ¡£', url: 'https://github.com/Lynnlgh0824/chiengmai-activities/blob/main/README.md', category: 'docs' },
                        { name: 'ğŸ§ª æµ‹è¯•æŒ‡å—', url: 'https://github.com/Lynnlgh0824/chiengmai-activities/blob/main/docs/TESTING-GUIDE.md', category: 'docs' },
                        { name: 'âš™ï¸ è‡ªåŠ¨åŒ–æŒ‡å—', url: 'file:///Users/yuzhoudeshengyin/Documents/my_project/Chiengmai/AUTOMATION-GUIDE.md', category: 'docs' },
                        { name: 'ğŸ”„ GitHub Actions', url: 'https://github.com/Lynnlgh0824/chiengmai-activities/actions', category: 'tools' },
                        { name: 'ğŸ“ æµ‹è¯•æ€»ç»“', url: 'file:///Users/yuzhoudeshengyin/Documents/my_project/Chiengmai/docs/TESTING-SUMMARY.md', category: 'docs' },
                        { name: 'ğŸ¬ AIè§†é¢‘å·¥å…·ç ”ç©¶', url: 'https://www.synthesia.io/', category: 'learning' },
                        { name: 'ğŸ¤– HeyGen è§†é¢‘ç”Ÿæˆ', url: 'https://www.heygen.com/', category: 'learning' },
                        { name: 'ğŸ“º SaaSäº§å“æ¡ˆä¾‹', url: 'https://www.producthunt.com/', category: 'learning' }
                    ]
                },
                folder: '/Users/yuzhoudeshengyin/Desktop/AIç›¸å…³é¡¹ç›®/æ¸…è¿ˆæ´»åŠ¨/',
                projectFolder: '/Users/yuzhoudeshengyin/Documents/my_project/Chiengmai/',
                serverPort: 8001
            },
            'planning-system': {
                summary: {
                    title: 'ğŸ“‹ Planning æ–‡ä»¶ç®¡ç†ç³»ç»Ÿ',
                    description: 'å¼€å‘æµç¨‹ã€éœ€æ±‚æ¨¡æ¿ã€BugæŠ¥å‘Šç­‰',
                    achievements: [
                        'âœ… åˆ›å»ºéœ€æ±‚æ¨¡æ¿æ–‡æ¡£',
                        'âœ… åˆ›å»ºBugæŠ¥å‘Šæ¨¡æ¿',
                        'âœ… åˆ›å»ºå¼€å‘æµç¨‹è§„èŒƒ'
                    ],
                    docs: [
                        { name: 'ğŸ“– Planningä½¿ç”¨æŒ‡å—', url: '/Users/yuzhoudeshengyin/Documents/my_project/Planning-with-Files-ä½¿ç”¨æŒ‡å—.md', category: 'docs' }
                    ]
                },
                folder: '/Users/yuzhoudeshengyin/Documents/my_project/'
            },
            'skills-development': {
                summary: {
                    title: 'âš¡ æŠ€èƒ½å¼€å‘ä¸å­¦ä¹ ',
                    description: 'Claude Code æŠ€èƒ½å’Œå·¥å…·é›†',
                    achievements: [
                        'âœ… ç ”ç©¶Claude CodeæŠ€èƒ½å¼€å‘',
                        'âœ… æ•´ç†å¼€å‘å·¥å…·å’Œèµ„æº'
                    ],
                    docs: [
                        { name: 'ğŸ“– éœ€æ±‚æ¨¡æ¿', url: '/Users/yuzhoudeshengyin/Documents/my_project/english-learning/docs/REQUIREMENT-TEMPLATE.md', category: 'docs' },
                        { name: 'ğŸ› BugæŠ¥å‘Šæ¨¡æ¿', url: '/Users/yuzhoudeshengyin/Documents/my_project/english-learning/docs/BUG-REPORT-TEMPLATE.md', category: 'docs' },
                        { name: 'ğŸ”„ å¼€å‘æµç¨‹', url: '/Users/yuzhoudeshengyin/Documents/my_project/english-learning/docs/DEVELOPMENT-PROCESS.md', category: 'docs' },
                        { name: 'ğŸ’¬ æ²Ÿé€šåè®®', url: '/Users/yuzhoudeshengyin/Documents/my_project/english-learning/docs/COMMUNICATION-PROTOCOL.md', category: 'docs' },
                        { name: 'ğŸ“ˆ æ”¹è¿›æŒ‡å—', url: '/Users/yuzhoudeshengyin/Documents/my_project/english-learning/docs/IMPROVEMENT-GUIDE.md', category: 'docs' },
                        { name: 'ğŸ¯ é¡¹ç›®ç®¡ç†æœ€ä½³å®è·µ', url: 'https://www.pmi.org/', category: 'learning' },
                        { name: 'ğŸ’¡ æ•æ·å¼€å‘', url: 'https://www.scrum.org/', category: 'learning' },
                        { name: 'ğŸ“Š ä»£ç è´¨é‡ç®¡ç†', url: 'https://www.sonarsource.com/', category: 'learning' },
                        { name: 'ğŸ§ª æµ‹è¯•é©±åŠ¨å¼€å‘', url: 'https://jestjs.io/', category: 'learning' },
                        { name: 'ğŸ¨ UI/UX è®¾è®¡åŸåˆ™', url: 'https://www.nngroup.com/', category: 'learning' },
                        { name: 'ğŸ“ æŠ€æœ¯å†™ä½œ', url: 'https://developers.google.com/tech-writing', category: 'learning' },
                        { name: 'ğŸ” ä»£ç å®¡æŸ¥', url: 'https://www.phacility.com/arcanist/', category: 'learning' },
                        { name: 'ğŸ  ä¸»é¡µï¼ˆè‡ªåŠ¨é€‚é…ï¼‰', url: 'http://localhost:3000/index.html', category: 'docs' },
                        { name: 'âš™ï¸ ç®¡ç†é¡µé¢', url: 'http://localhost:3000/admin.html', category: 'docs' },
                        { name: 'ğŸ§ª ç»¼åˆæµ‹è¯•é¢æ¿', url: 'http://localhost:3000/test-dashboard.html', category: 'tools' },
                        { name: 'ğŸ“Š è®¿é—®ä»ªè¡¨æ¿', url: 'http://localhost:3000/tests/test-dashboard-enhanced.html', category: 'tools' },
                        { name: 'ğŸ”Œ åº”ç”¨ç‰ˆæœ¬ API', url: 'http://localhost:3000/app/version', category: 'tools' },
                        { name: 'ğŸ“¡ æ•°æ®ç‰ˆæœ¬ API', url: 'http://localhost:3000/api/version', category: 'tools' },
                        { name: 'ğŸ“Š æ´»åŠ¨æ•°æ® API', url: 'http://localhost:3000/api/activities', category: 'tools' },
                        { name: 'ğŸ“– æµ‹è¯•æ€ç»´æ–¹æ³•è®º', url: 'http://localhost:3000/docs/æµ‹è¯•æ€ç»´æ–¹æ³•è®º.md', category: 'docs' },
                        { name: 'ğŸ“š æµ‹è¯•åŠŸèƒ½è¯´æ˜', url: 'http://localhost:3000/docs/æµ‹è¯•åŠŸèƒ½è¯´æ˜.md', category: 'docs' },
                        { name: 'ğŸ—‚ï¸ é¡¹ç›®æ–‡ä»¶ç»“æ„', url: 'http://localhost:3000/docs/é¡¹ç›®æ–‡ä»¶ç»“æ„è¯´æ˜.md', category: 'docs' },
                        { name: 'ğŸ“‹ é¡¹ç›®é“¾æ¥æ¸…å•', url: 'http://localhost:3000/docs/é¡¹ç›®é“¾æ¥æ¸…å•.md', category: 'docs' }
                    ],
                },
                skills: '/Users/yuzhoudeshyin/.claude/skills/',
                desktop: '/Users/yuzhoudeshengyin/Desktop/',
                folder: '/Users/yuzhoudeshengyin/Documents/my_project/skills/'
            }
        };

        // é“¾æ¥åˆ†ç±»é…ç½®
        const linkCategories = {
            'docs': { icon: 'ğŸ“š', title: 'æ–‡æ¡£èµ„æ–™', color: '#5c7cfa', desc: 'é¡¹ç›®æ–‡æ¡£ã€ä½¿ç”¨æŒ‡å—' },
            'tools': { icon: 'ğŸ› ï¸', title: 'å·¥å…·å’Œæµ‹è¯•', color: '#ff9800', desc: 'æµ‹è¯•å·¥å…·ã€è‡ªåŠ¨åŒ–è„šæœ¬' },
            'learning': { icon: 'ğŸ¬', title: 'å­¦ä¹ èµ„æº', color: '#4caf50', desc: 'è§†é¢‘å­¦ä¹ è®°å½•' },
            'paths': { icon: 'ğŸ“‚', title: 'é¡¹ç›®è·¯å¾„', color: '#9c27b0', desc: 'æ–‡ä»¶å¤¹å’Œå·¥ä½œåŒº' }
        };

        let currentProjectFilter = null; // å½“å‰ç­›é€‰çš„é¡¹ç›®ID

        // æ¸²æŸ“é¡¹ç›®åˆ—è¡¨
        function renderProjectList() {
            const projects = getProjects();
            const container = document.getElementById('projectList');
            container.innerHTML = '';

            // æ·»åŠ "å…¨éƒ¨é¡¹ç›®"é€‰é¡¹
            const allDiv = document.createElement('div');
            allDiv.className = 'project-item' + (currentProjectFilter === null ? ' active' : '');
            allDiv.onclick = () => filterByProject(null);
            allDiv.innerHTML = `
                <div class="project-name">ğŸ“‚ å…¨éƒ¨é¡¹ç›®</div>
                <div class="project-date">æŸ¥çœ‹æ‰€æœ‰æ—¥å¿—</div>
            `;
            container.appendChild(allDiv);

            projects.forEach(project => {
                const div = document.createElement('div');
                div.className = 'project-item' + (currentProjectFilter === project.id ? ' active' : '');
                div.onclick = () => filterByProject(project.id);
                div.innerHTML = `
                    <div class="project-name">${project.name}</div>
                    <div class="project-date">å¼€å§‹: ${project.startDate}</div>
                `;
                container.appendChild(div);
            });

            renderProjectStats();
        }

        // æ¸²æŸ“é¡¹ç›®ç»Ÿè®¡
        function renderProjectStats() {
            const projects = getProjects();
            const logs = getLogs();
            const container = document.getElementById('projectStats');

            let html = '';

            projects.forEach(project => {
                const projectLogs = logs.filter(log => log.projectId === project.id);
                const days = [...new Set(projectLogs.map(log => log.date))].length;

                html += `
                    <div style="margin-bottom: 15px; font-size: 13px;">
                        <div style="font-weight: 600; margin-bottom: 5px;">${project.name}</div>
                        <div style="color: #666;">
                            ğŸ“ ${projectLogs.length} æ¡æ—¥å¿— | ğŸ“… ${days} å¤©
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        // æŒ‰é¡¹ç›®ç­›é€‰
        function filterByProject(projectId) {
            currentProjectFilter = projectId;
            renderProjectList();
            renderAll();

            // æ£€æŸ¥å½“å‰æ´»è·ƒçš„æ ‡ç­¾é¡µå¹¶é‡æ–°æ¸²æŸ“å†…å®¹
            const activeTabBtn = document.querySelector('.tab-btn.active');
            if (activeTabBtn) {
                const tabText = activeTabBtn.textContent;
                if (tabText.includes('ğŸ“š é¡¹ç›®ç»éªŒæ€»ç»“')) {
                    renderSummaryContent();
                } else if (tabText.includes('ğŸ”— é¡¹ç›®é“¾æ¥æ±‡æ€»')) {
                    renderLinksContent();
                } else if (tabText.includes('âœ… å¾…åŠæ¸…å•')) {
                    renderTodosContent();
                } else {
                    // å¦‚æœä¸åœ¨æ€»ç»“ã€é“¾æ¥æˆ–å¾…åŠæ ‡ç­¾é¡µï¼Œåˆ‡æ¢åˆ°å·¥ä½œæ—¥å¿—
                    switchTab('logs');
                }
            } else {
                // å¦‚æœæ²¡æœ‰æ´»è·ƒæ ‡ç­¾é¡µï¼Œåˆ‡æ¢åˆ°å·¥ä½œæ—¥å¿—
                switchTab('logs');
            }
        }

        // æ˜¾ç¤ºæ·»åŠ é¡¹ç›®è¡¨å•
        function showAddProjectForm() {
            document.getElementById('addProjectForm').style.display = 'block';
        }

        // éšè—æ·»åŠ é¡¹ç›®è¡¨å•
        function hideAddProjectForm() {
            document.getElementById('addProjectForm').style.display = 'none';
            document.getElementById('newProjectName').value = '';
        }

        // æ·»åŠ æ–°é¡¹ç›®
        function addNewProject() {
            const name = document.getElementById('newProjectName').value.trim();
            if (!name) {
                alert('è¯·è¾“å…¥é¡¹ç›®åç§°');
                return;
            }

            const projects = getProjects();
            const newProject = {
                id: 'project-' + Date.now(),
                name: name,
                startDate: new Date().toISOString().split('T')[0]
            };

            projects.push(newProject);
            localStorage.setItem(PROJECTS_KEY, JSON.stringify(projects));

            hideAddProjectForm();
            renderProjectList();

            // æ›´æ–°æ—¥å¿—è¡¨å•çš„é¡¹ç›®é€‰æ‹©å™¨
            updateProjectSelector();

            alert('âœ… é¡¹ç›®å·²æ·»åŠ ');
        }

        // æ›´æ–°é¡¹ç›®é€‰æ‹©å™¨
        function updateProjectSelector() {
            const projects = getProjects();
            const select = document.getElementById('projectSelect');
            const currentValue = select.value;

            select.innerHTML = projects.map(p =>
                `<option value="${p.id}">${p.name}</option>`
            ).join('') + '<option value="other">å…¶ä»–é¡¹ç›®</option>';

            if (currentValue) {
                select.value = currentValue;
            }
        }

        // ç”Ÿæˆå†å²é¡¹ç›®æ—¥å¿—ï¼ˆåªè®°å½•æœ‰å®é™…ç¼–ç å·¥ä½œçš„æ—¥æœŸï¼‰
        function generateProjectHistory() {
            const logs = getLogs();

            // å¦‚æœå·²æœ‰æ—¥å¿—ï¼Œä¸å†ç”Ÿæˆ
            if (logs.length > 0) {
                return;
            }

            const historyLogs = [];

            // 2æœˆ6æ—¥ï¼šé¡¹ç›®ç»„ç»‡ä¸ç®¡ç†
            historyLogs.push({
                id: Date.now().toString(),
                projectId: 'project-organization',
                projectName: 'é¡¹ç›®ç»„ç»‡ä¸ç®¡ç†',
                date: '2026-02-06',
                datetime: new Date().toLocaleString('zh-CN'),
                title: 'ğŸ—‚ï¸ é¡¹ç›®ç»„ç»‡ä¼˜åŒ– + æ¡Œé¢é“¾æ¥ä¿®å¤',
                tags: [{ name: 'ğŸš€ ä¼˜åŒ–', type: 'improvement' }, { name: 'ğŸ”§ ä¿®å¤', type: 'fix' }],
                items: [
                    'âœ… æ¸…ç†é¡¹ç›®ç›®å½• - å°† Chiengmai.backup å’Œ Chiengmai-backup-20260129-011001 å‹ç¼©å½’æ¡£åˆ° Chiengmai/archives',
                    'âœ… é‡ç»„é¡¹ç›®ç»“æ„ - åˆ›å»º project summary ç›®å½•ï¼Œé›†ä¸­ç®¡ç†é¡¹ç›®æ—¥å¿—å’Œç»éªŒæ€»ç»“',
                    'âœ… ä¿®å¤æ¡Œé¢å¿«æ·æ–¹å¼ - æ›´æ–° ğŸ“…é¡¹ç›®æ—¥å¿—.html å’Œ ğŸ“šé¡¹ç›®ç»éªŒæ€»ç»“.html é“¾æ¥è·¯å¾„',
                    'âœ… ä¿®å¤"æ‰“å¼€è‹±è¯­å­¦ä¹ .app" - æ¸…ç†æ—§è¿›ç¨‹ï¼Œæ›´æ–°è·¯å¾„åˆ° ~/Documents/my_project/english-learning',
                    'âœ… æ·»åŠ æ•°æ®è‡ªåŠ¨ä¿å­˜ - ä½¿ç”¨ File System Access API å®ç°æœ¬åœ°æ–‡ä»¶è‡ªåŠ¨ä¿å­˜',
                    'âœ… ä¼˜åŒ–é¡¹ç›®æ—¥å¿—ç³»ç»Ÿ - æ·»åŠ æ¬¢è¿å¼•å¯¼ã€ä¿å­˜æç¤ºã€å¼‚æ­¥éé˜»å¡ä¿å­˜',
                    'âœ… åˆ›å»ºå½’æ¡£è§„èŒƒ - Chiengmai/archives/README.md',
                    'âœ… æ›´æ–°æ¡Œé¢é“¾æ¥éªŒè¯ - ç¡®ä¿æ‰€æœ‰3ä¸ªæ¡Œé¢å›¾æ ‡æ­£å¸¸å·¥ä½œ'
                ],
                code: `// æ•°æ®è‡ªåŠ¨ä¿å­˜å®ç°
async function autoSaveToFile(logs) {
    if (fileHandle) {
        const writable = await fileHandle.createWritable();
        await writable.write(JSON.stringify(data, null, 2));
        await writable.close();
        showSaveNotification();
        return;
    }
    setTimeout(async () => {
        fileHandle = await window.showSaveFilePicker({...});
    }, 100);
}`
            });

            // 2æœˆ6æ—¥ï¼šTTSåŠŸèƒ½å®Œå–„ + UIä¼˜åŒ–
            historyLogs.push({
                id: (Date.now() - 1).toString(),
                projectId: 'english-learning-tts',
                projectName: 'è‹±è¯­å­¦ä¹  TTS ç³»ç»Ÿ',
                date: '2026-02-06',
                datetime: new Date(Date.now() - 1000).toLocaleString('zh-CN'),
                title: 'ğŸ¨ TTS UIä¼˜åŒ– + ç”¨æˆ·ä½“éªŒæå‡',
                tags: [{ name: 'ğŸš€ ä¼˜åŒ–', type: 'improvement' }],
                items: [
                    'âœ… å®ç°å¥å­é—´1ç§’åœé¡¿ - ä½¿ç”¨é€’å½’æ’­æ”¾ + setTimeout',
                    'âœ… è°ƒæ•´è¯­é€Ÿè®¾ç½® - å¿«é€Ÿ1.0xã€æ ‡å‡†0.5xã€ç¼“æ…¢0.25x',
                    'âœ… ä¼˜åŒ–æ§åˆ¶é¢æ¿å¸ƒå±€ - å›ºå®šå®½åº¦840pxï¼Œé˜²æ­¢é®æŒ¡å†…å®¹',
                    'âœ… å®ç°é¢æ¿ç²˜æ€§å®šä½ - æ»šåŠ¨50pxåè‡ªåŠ¨å›ºå®šåœ¨é¡¶éƒ¨',
                    'âœ… æ·»åŠ å ä½å…ƒç´  - é˜²æ­¢é¢æ¿å›ºå®šæ—¶å†…å®¹è·³åŠ¨',
                    'âœ… ä¼˜åŒ–æŒ‰é’®æ ·å¼ - æ¿€æ´»çŠ¶æ€åŠ å®½ã€åŠ ç²—ã€ä¸»é¢˜è‰²æ¸å˜',
                    'âœ… æ›´æ¢å›¾æ ‡ - æœ—è¯»æŒ‰é’®ğŸ™ï¸ã€æ ‡å‡†æ¨¡å¼ğŸ”¥ã€ç¼“æ…¢æ¨¡å¼ğŸ“š',
                    'âœ… ç¼©å°è¯­éŸ³é€‰æ‹©æ¡†å®½åº¦ - æœ€å¤§200pxã€æœ€å°150px',
                    'âœ… ç§»é™¤"ä»åˆ’è¯åŒºåŸŸå¼€å§‹"æŒ‰é’® - åŠŸèƒ½æ•´åˆåˆ°æ’­æ”¾æŒ‰é’®',
                    'âœ… æ’­æ”¾æŒ‰é’®æ™ºèƒ½åˆ¤æ–­ - ä¼˜å…ˆä»é€‰ä¸­ä½ç½®å¼€å§‹æ’­æ”¾',
                    'âœ… è¡¥å……å†å²æ—¥å¿— - æ ¹æ®å®é™…å·¥ä½œå†…å®¹è‡ªåŠ¨ç”Ÿæˆ'
                ],
                code: null
            });

            // 2æœˆ5æ—¥ï¼šTTSæ ¸å¿ƒé—®é¢˜ä¿®å¤
            historyLogs.push({
                id: (Date.now() - 1).toString(),
                projectId: 'english-learning-tts',
                projectName: 'è‹±è¯­å­¦ä¹  TTS ç³»ç»Ÿ',
                date: '2026-02-05',
                datetime: new Date(Date.now() - 86400000).toLocaleString('zh-CN'),
                title: 'ğŸ”§ TTSæ ¸å¿ƒé—®é¢˜ä¿®å¤',
                tags: [{ name: 'ğŸ”§ ä¿®å¤', type: 'fix' }, { name: 'âœ¨ æ–°åŠŸèƒ½', type: 'feature' }],
                items: [
                    'âœ… ä¿®å¤TTSé˜Ÿåˆ—ç­–ç•¥ - è§£å†³æµè§ˆå™¨è‡ªåŠ¨æ’­æ”¾ç­–ç•¥ not-allowed é”™è¯¯',
                    'âœ… ä¿®å¤å˜é‡ä½œç”¨åŸŸ - enhancedVoices ç»Ÿä¸€ä½¿ç”¨ window.enhancedVoices',
                    'âœ… ä¿®å¤ç±»å‹è½¬æ¢ - voiceSelect.value æ·»åŠ  parseInt()',
                    'âœ… åˆ é™¤é‡å¤ä»£ç  - ç§»é™¤4ä¸ªHTMLæ–‡ä»¶ä¸­903è¡Œé‡å¤ä»£ç ',
                    'âœ… åˆ›å»ºå…¬å…±è„šæœ¬ - tts-common.jsã€page-common.jsã€tts-common.css',
                    'âœ… åˆ›å»ºè‡ªåŠ¨åŒ–æµ‹è¯• - auto-test-runner.htmlï¼ˆ7é¡¹æµ‹è¯•ï¼‰',
                    'âœ… åˆ›å»ºæ—¥å¿—ç³»ç»Ÿ - project-log.htmlï¼ˆæŒ‰æ—¥æœŸå’Œé¡¹ç›®ç»„ç»‡ï¼‰',
                    'âœ… åˆ›å»ºç»éªŒæ€»ç»“ - PROJECT-SUMMARY.htmlï¼ˆ9å¤§è¸©å‘+æœ€ä½³å®è·µï¼‰',
                    'âœ… åˆ›å»ºæµç¨‹æ–‡æ¡£ - éœ€æ±‚æ¨¡æ¿ã€BugæŠ¥å‘Šã€æ²Ÿé€šåè®®ã€å¼€å‘æµç¨‹',
                    'âœ… åˆ›å»ºéªŒè¯è„šæœ¬ - scripts/validate-project.shï¼ˆ53é¡¹æ£€æŸ¥ï¼‰',
                    'âœ… åˆ›å»ºæ¡Œé¢å¿«æ·æ–¹å¼ - é¡¹ç›®æ—¥å¿—ã€é¡¹ç›®ç»éªŒæ€»ç»“',
                    'âœ… åˆ›å»ºå­¦ä¹ è®°å½• - 4ä¸ªYouTubeè§†é¢‘å­¦ä¹ å·¥å…·åŒ…',
                    'ğŸ“Š TTSæ’­æ”¾æµ‹è¯•é€šè¿‡'
                ],
                code: null
            });

            // 1æœˆ22æ—¥ï¼šAI SaaSè§†é¢‘é¡¹ç›®è°ƒç ”
            historyLogs.push({
                id: (Date.now() - 2).toString(),
                projectId: 'aisaas-video',
                projectName: 'AI SaaS è§†é¢‘é¡¹ç›®',
                date: '2026-01-22',
                datetime: new Date(Date.now() - 86400000 * 15).toLocaleString('zh-CN'),
                title: 'ğŸ“š AIè§†é¢‘SaaSé¡¹ç›®è°ƒç ”',
                tags: [{ name: 'ğŸ“š å­¦ä¹ ', type: 'learning' }],
                items: [
                    'âœ… æ”¶é›†AIè§†é¢‘å¥—å£³ç«™ç›¸å…³èµ„æ–™',
                    'âœ… ç ”ç©¶è§†é¢‘SaaSç«™ç¬¬äºŒæ¬¡ç›´æ’­å†…å®¹',
                    'âœ… åˆ†æAIè§†é¢‘ç”Ÿæˆå·¥å…·å¸‚åœº'
                ],
                code: null
            });

            // 1æœˆ19æ—¥ï¼šæ¸…è¿ˆæ´»åŠ¨ç­–åˆ’
            historyLogs.push({
                id: (Date.now() - 3).toString(),
                projectId: 'chiang-mai-activities',
                projectName: 'æ¸…è¿ˆæ´»åŠ¨ç­–åˆ’',
                date: '2026-01-19',
                datetime: new Date(Date.now() - 86400000 * 18).toLocaleString('zh-CN'),
                title: 'ğŸ“‹ æ¸…è¿ˆæ´»åŠ¨ç­–åˆ’è°ƒç ”',
                tags: [{ name: 'ğŸ“š å­¦ä¹ ', type: 'learning' }],
                items: [
                    'âœ… æ•´ç†æ¸…è¿ˆæ´»åŠ¨ç›¸å…³èµ„æ–™',
                    'âœ… æ”¶é›†æ¸…è¿ˆå…¨æ”»ç•¥ä¿¡æ¯',
                    'âœ… ç ”ç©¶æ¸…è¿ˆå°çµé€šå°ç¨‹åºæ–¹æ¡ˆ'
                ],
                code: null
            });

            // ä¿å­˜ï¼ˆæŒ‰æ—¥æœŸå€’åºï¼‰
            saveLogs(historyLogs);
            console.log(`âœ… å·²ç”Ÿæˆ ${historyLogs.length} æ¡å†å²è®°å½•ï¼ˆåŸºäºå®é™…æ–‡ä»¶å’Œæ–‡æ¡£ï¼‰`);
        }

        // æ ‡ç­¾é¡µåˆ‡æ¢
        function switchTab(tabName) {
            // éšè—æ‰€æœ‰æ ‡ç­¾é¡µå†…å®¹
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.style.display = 'none';
            });

            // ç§»é™¤æ‰€æœ‰æ ‡ç­¾æŒ‰é’®çš„activeçŠ¶æ€
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            // æ˜¾ç¤ºé€‰ä¸­çš„æ ‡ç­¾é¡µ
            document.getElementById('tab-' + tabName).style.display = 'block';

            // æ¿€æ´»å¯¹åº”æŒ‰é’®ï¼ˆé€šè¿‡onclickäº‹ä»¶æˆ–æ‰‹åŠ¨æŸ¥æ‰¾ï¼‰
            if (event && event.target) {
                event.target.classList.add('active');
            } else {
                // å¦‚æœæ²¡æœ‰eventå¯¹è±¡ï¼Œæ‰‹åŠ¨æŸ¥æ‰¾å¹¶æ¿€æ´»å¯¹åº”æŒ‰é’®
                const tabs = {
                    'logs': 'ğŸ“… å·¥ä½œæ—¥å¿—',
                    'summary': 'ğŸ“š é¡¹ç›®ç»éªŒæ€»ç»“',
                    'links': 'ğŸ”— é¡¹ç›®é“¾æ¥æ±‡æ€»',
                    'todos': 'âœ… å¾…åŠæ¸…å•',
                    'check': 'ğŸ” é¡¹ç›®æ£€æŸ¥'
                };
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    if (btn.textContent.includes(tabs[tabName])) {
                        btn.classList.add('active');
                    }
                });
            }

            // æ ¹æ®æ ‡ç­¾é¡µæ¸²æŸ“åŠ¨æ€å†…å®¹
            if (tabName === 'summary') {
                renderSummaryContent();
            } else if (tabName === 'links') {
                renderLinksContent();
            } else if (tabName === 'todos') {
                renderTodosContent();
            } else if (tabName === 'check') {
                // é¡¹ç›®æ£€æŸ¥æ ‡ç­¾é¡µ
            }
        }

        // æ¸²æŸ“é¡¹ç›®ç»éªŒæ€»ç»“å†…å®¹
        function renderSummaryContent() {
            const container = document.getElementById('summaryContent');
            const projectId = currentProjectFilter;

            if (!projectId) {
                // æ˜¾ç¤ºæ‰€æœ‰é¡¹ç›®çš„ç®€è¦æ€»ç»“
                const allProjects = getProjects();
                let html = '<h2 style="margin-bottom: 20px;">ğŸ“š å…¨éƒ¨é¡¹ç›®ç»éªŒæ€»ç»“</h2>';
                html += '<div style="display: grid; gap: 15px;">';

                allProjects.forEach(project => {
                    const data = projectData[project.id];
                    if (!data || !data.summary) return;

                    const summary = data.summary;
                    html += `
                        <div style="background: rgba(227, 244, 255, 0.7); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); padding: 20px; border-radius: 12px; cursor: pointer; border: 2px solid rgba(92, 124, 250, 0.2); transition: all 0.3s ease; box-shadow: 0 4px 16px rgba(92,124,250,0.08);" onclick="filterByProject('${project.id}')" onmouseover="this.style.borderColor='#5c7cfa'; this.style.transform='translateY(-3px)'; this.style.boxShadow='0 8px 24px rgba(92,124,250,0.2)'" onmouseout="this.style.borderColor='rgba(92, 124, 250, 0.2)'; this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 16px rgba(92,124,250,0.08)'">
                            <h3 style="color: #5c7cfa; margin-bottom: 10px;">${summary.title}</h3>
                            <p style="color: #666; margin-bottom: 10px;">${summary.description}</p>
                            <p style="font-size: 12px; color: #999;">ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ… â†’</p>
                        </div>
                    `;
                });

                html += '</div>';
                container.innerHTML = html;
                return;
            }

            const project = getProjects().find(p => p.id === projectId);
            const data = projectData[projectId];

            if (!data || !data.summary) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 60px 20px; color: #999;">
                        <div style="font-size: 48px; margin-bottom: 20px;">ğŸ“</div>
                        <p>è¯¥é¡¹ç›®æš‚æ— è¯¦ç»†æ€»ç»“ä¿¡æ¯</p>
                        <p style="font-size: 14px; margin-top: 10px;">ç‚¹å‡»å·¦ä¾§å…¶ä»–é¡¹ç›®æŸ¥çœ‹è¯¦æƒ…</p>
                    </div>
                `;
                return;
            }

            const summary = data.summary;
            let html = `
                <div style="background: #f0f4ff; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                    <h2 style="margin-bottom: 15px;">${summary.title}</h2>
                    <p style="color: #666; margin-bottom: 15px;">${summary.description}</p>
                </div>

                <h3 style="margin-bottom: 15px;">ğŸ¯ ä¸»è¦æˆæœ</h3>
                <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                    <ul style="line-height: 2;">
                        ${summary.achievements.map(a => `<li>${a}</li>`).join('')}
                    </ul>
                </div>
            `;

            if (summary.docs && summary.docs.length > 0) {
                html += `
                    <h3 style="margin-bottom: 15px;">ğŸ“š ç›¸å…³æ–‡æ¡£</h3>
                    <div style="display: grid; gap: 10px;">
                        ${summary.docs.map(doc => `
                            <a href="${doc.url}" target="_blank" class="link-card">
                                <div class="link-card-title">${doc.name}</div>
                            </a>
                        `).join('')}
                    </div>
                `;
            } else {
                html += `
                    <div class="empty-state-enhanced">
                        <div class="emoji">ğŸ“‚</div>
                        <div class="message">æš‚æ— ç›¸å…³æ–‡æ¡£</div>
                        <div class="hint">è¯¥é¡¹ç›®è¿˜æœªæ·»åŠ ç›¸å…³æ–‡æ¡£é“¾æ¥</div>
                    </div>
                `;
            }

            container.innerHTML = html;
        }

        // æ¸²æŸ“é¡¹ç›®é“¾æ¥æ±‡æ€»å†…å®¹
        function renderLinksContent() {
            const container = document.getElementById('linksContent');
            const projectId = currentProjectFilter;

            if (!projectId) {
                // æ˜¾ç¤ºæ‰€æœ‰é¡¹ç›®çš„é“¾æ¥æ±‡æ€» - æŒ‰ä¸€çº§åˆ†ç±»åˆ†ç»„
                const allProjects = getProjects();
                let html = '<h2 style="margin-bottom: 20px;">ğŸ”— å…¨éƒ¨é¡¹ç›®é“¾æ¥æ±‡æ€»</h2>';

                // æŒ‰åˆ†ç±»æ”¶é›†æ‰€æœ‰é“¾æ¥
                const categorizedByType = {
                    'docs': [],
                    'tools': [],
                    'learning': [],
                    'paths': []
                };

                allProjects.forEach(project => {
                    const data = projectData[project.id];
                    if (!data) return;

                    // æ”¶é›†æ–‡æ¡£é“¾æ¥
                    if (data.summary && data.summary.docs && data.summary.docs.length > 0) {
                        data.summary.docs.forEach(doc => {
                            const cat = doc.category || 'docs';
                            if (categorizedByType[cat]) {
                                categorizedByType[cat].push({
                                    ...doc,
                                    projectName: project.name,
                                    projectId: project.id
                                });
                            }
                        });
                    }

                    // æ”¶é›†è·¯å¾„é“¾æ¥
                    if (data.folder) {
                        categorizedByType.paths.push({
                            name: 'ğŸ“‚ é¡¹ç›®æ–‡ä»¶å¤¹',
                            path: data.folder,
                            projectName: project.name,
                            projectId: project.id,
                            type: 'folder'
                        });
                    }
                    if (data.projectFolder) {
                        categorizedByType.paths.push({
                            name: 'ğŸ’» é¡¹ç›®å·¥ä½œåŒº',
                            path: data.projectFolder,
                            projectName: project.name,
                            projectId: project.id,
                            type: 'projectFolder'
                        });
                    }
                    if (data.skills) {
                        categorizedByType.paths.push({
                            name: 'âš¡ Claude Skills',
                            path: data.skills,
                            projectName: project.name,
                            projectId: project.id,
                            type: 'skills'
                        });
                    }
                    if (data.desktop) {
                        categorizedByType.paths.push({
                            name: 'ğŸ–¥ï¸ Desktop æ¡Œé¢',
                            path: data.desktop,
                            projectName: project.name,
                            projectId: project.id,
                            type: 'desktop'
                        });
                    }
                });

                // æ˜¾ç¤ºå„ä¸ªåˆ†ç±»
                Object.keys(categorizedByType).forEach(cat => {
                    const items = categorizedByType[cat];
                    if (items.length === 0) return;

                    const catInfo = linkCategories[cat];

                    html += `
                        <div class="category-header" style="border-left-color: ${catInfo.color}; margin-top: 30px;">
                            <span class="icon">${catInfo.icon}</span>
                            <span class="title">${catInfo.title}</span>
                            <span class="desc">${catInfo.desc}</span>
                            <span class="count">${items.length}</span>
                        </div>
                    `;
                    html += '<div class="links-container">';

                    items.forEach(item => {
                        if (cat === 'paths') {
                            html += `
                                <a href="${item.path}" target="_blank" class="link-card link-card-${cat}" onclick="event.stopPropagation()">
                                    <div class="link-card-title">
                                        <strong>${item.name}</strong>
                                        <span style="color: #999; font-weight: 400; font-size: 12px; margin-left: 8px;">${item.projectName}</span>
                                    </div>
                                    <div class="link-card-path">${item.path}</div>
                                </a>
                            `;
                        } else {
                            html += `
                                <a href="${item.url}" target="_blank" class="link-card link-card-${cat}" onclick="event.stopPropagation()">
                                    <div class="link-card-title">
                                        <strong>${item.name}</strong>
                                        <span style="color: #999; font-weight: 400; font-size: 12px; margin-left: 8px;">${item.projectName}</span>
                                    </div>
                                </a>
                            `;
                        }
                    });

                    html += '</div>';
                });

                container.innerHTML = html;
                return;
            }

            // æ˜¾ç¤ºç‰¹å®šé¡¹ç›®çš„é“¾æ¥ï¼ˆæŒ‰åˆ†ç±»ï¼‰
            const project = getProjects().find(p => p.id === projectId);
            const data = projectData[projectId];

            if (!data) {
                container.innerHTML = `
                    <div class="empty-state-enhanced">
                        <div class="emoji">ğŸ”—</div>
                        <div class="message">è¯¥é¡¹ç›®æš‚æ— é“¾æ¥ä¿¡æ¯</div>
                        <div class="hint">ç‚¹å‡»å·¦ä¾§å…¶ä»–é¡¹ç›®æŸ¥çœ‹é“¾æ¥</div>
                    </div>
                `;
                return;
            }

            let html = `<h2 style="margin-bottom: 20px;">ğŸ”— ${project.name} - é“¾æ¥æ±‡æ€»</h2>`;
            html += '<div class="links-container">';

            // æŒ‰åˆ†ç±»åˆ†ç»„æ–‡æ¡£é“¾æ¥
            const categorizedLinks = {};
            const hasPathLinks = data.folder || data.projectFolder || data.skills || data.desktop;

            if (data.summary && data.summary.docs && data.summary.docs.length > 0) {
                data.summary.docs.forEach(doc => {
                    const cat = doc.category || 'docs';
                    if (!categorizedLinks[cat]) categorizedLinks[cat] = [];
                    categorizedLinks[cat].push(doc);
                });
            }

            // æ˜¾ç¤ºåˆ†ç±»é“¾æ¥
            Object.keys(categorizedLinks).sort().forEach(cat => {
                const catInfo = linkCategories[cat] || linkCategories['docs'];
                const links = categorizedLinks[cat];

                html += `
                    <div class="category-header" style="border-left-color: ${catInfo.color};">
                        <span class="icon">${catInfo.icon}</span>
                        <span class="title">${catInfo.title}</span>
                        <span class="desc">${catInfo.desc}</span>
                        <span class="count">${links.length}</span>
                    </div>
                `;

                links.forEach(doc => {
                    html += `
                        <a href="${doc.url}" target="_blank" class="link-card link-card-${cat}">
                            <div class="link-card-title">${doc.name}</div>
                        </a>
                    `;
                });
            });

            // æ˜¾ç¤ºè·¯å¾„é“¾æ¥
            if (hasPathLinks) {
                html += `
                    <div class="category-header" style="border-left-color: ${linkCategories.paths.color};">
                        <span class="icon">${linkCategories.paths.icon}</span>
                        <span class="title">${linkCategories.paths.title}</span>
                        <span class="desc">${linkCategories.paths.desc}</span>
                    </div>
                `;

                if (data.folder) {
                    html += `
                        <a href="${data.folder}" target="_blank" class="link-card link-card-paths">
                            <div class="link-card-title">ğŸ“‚ é¡¹ç›®æ–‡ä»¶å¤¹</div>
                            <div class="link-card-path">${data.folder}</div>
                        </a>
                    `;
                }
                if (data.projectFolder) {
                    html += `
                        <a href="${data.projectFolder}" target="_blank" class="link-card link-card-paths">
                            <div class="link-card-title">ğŸ’» é¡¹ç›®å·¥ä½œåŒº</div>
                            <div class="link-card-path">${data.projectFolder}</div>
                        </a>
                    `;
                }
                if (data.skills) {
                    html += `
                        <a href="${data.skills}" target="_blank" class="link-card link-card-paths">
                            <div class="link-card-title">âš¡ Claude Skills</div>
                            <div class="link-card-path">${data.skills}</div>
                        </a>
                    `;
                }
                if (data.desktop) {
                    html += `
                        <a href="${data.desktop}" target="_blank" class="link-card link-card-paths">
                            <div class="link-card-title">ğŸ–¥ï¸ Desktop æ¡Œé¢</div>
                            <div class="link-card-path">${data.desktop}</div>
                        </a>
                    `;
                }
            }

            html += '</div>';

            if (!Object.keys(categorizedLinks).length && !hasPathLinks) {
                html = `
                    <div class="empty-state-enhanced">
                        <div class="emoji">ğŸ”—</div>
                        <div class="message">è¯¥é¡¹ç›®æš‚æ— é“¾æ¥ä¿¡æ¯</div>
                        <div class="hint">ç‚¹å‡»å·¦ä¾§å…¶ä»–é¡¹ç›®æŸ¥çœ‹é“¾æ¥</div>
                    </div>
                `;
            }

            container.innerHTML = html;
        }

        // æ¸²æŸ“å¾…åŠæ¸…å•å†…å®¹
        function renderTodosContent() {
            const container = document.getElementById('todosContent');
            const projectId = currentProjectFilter;
            const todos = getTodos();
            const projects = getProjects();

            if (!projectId) {
                // æ˜¾ç¤ºæ‰€æœ‰é¡¹ç›®çš„å¾…åŠæ¸…å•
                let html = '<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">';
                html += '<h2 style="margin: 0;">âœ… å…¨éƒ¨é¡¹ç›®å¾…åŠæ¸…å•</h2>';
                html += '<div style="display: flex; gap: 10px;">';
                html += '<button class="btn-quick-add" onclick="showQuickAddTodo()">â• å¿«é€Ÿæ·»åŠ å¾…åŠ</button>';
                html += '<button class="btn btn-success" onclick="extractTodosFromTodayLog()">ğŸ“¥ ä»ä»Šæ—¥æ—¥å¿—æå–</button>';
                html += '</div></div>';

                // å¿«é€Ÿæ·»åŠ å¾…åŠè¡¨å•
                html += `
                    <div id="quickAddTodoForm" style="display: none; background: rgba(227, 244, 255, 0.7); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); padding: 20px; border-radius: 12px; margin-bottom: 20px; border: 2px solid rgba(92, 124, 250, 0.3); box-shadow: 0 8px 32px rgba(92, 124, 250, 0.1);">
                        <h3 style="margin: 0 0 15px 0; font-size: 16px;">â• å¿«é€Ÿæ·»åŠ å¾…åŠäº‹é¡¹</h3>
                        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                            <select id="quickTodoProject" style="flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; background: white;">
                                <option value="">é€‰æ‹©é¡¹ç›®...</option>
                                ${projects.map(p => `<option value="${p.id}">${p.name}</option>`).join('')}
                            </select>
                            <select id="quickTodoPriority" style="width: 120px; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; background: white;">
                                <option value="high">ğŸ”´ é«˜</option>
                                <option value="medium" selected>ğŸŸ¡ ä¸­</option>
                                <option value="low">ğŸŸ¢ ä½</option>
                            </select>
                        </div>
                        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                            <textarea id="quickTodoText" class="form-control" placeholder="è¾“å…¥å¾…åŠäº‹é¡¹ï¼ˆæ¯è¡Œä¸€ä¸ªï¼‰&#10;ä¾‹å¦‚ï¼š&#10;ä¿®å¤ç™»å½•bug&#10;ä¼˜åŒ–é¦–é¡µåŠ è½½&#10;æ·»åŠ ç”¨æˆ·åé¦ˆåŠŸèƒ½" rows="4" style="flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; resize: vertical; min-height: 80px;"></textarea>
                            <div style="display: flex; flex-direction: column; gap: 10px;">
                                <input type="date" id="quickTodoDueDate" style="padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;">
                            </div>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-success" onclick="quickAddTodo()">æ·»åŠ </button>
                            <button class="btn btn-primary" onclick="hideQuickAddTodo()">å–æ¶ˆ</button>
                        </div>
                    </div>
                `;

                const hasTodos = projects.some(p => todos[p.id] && todos[p.id].length > 0);

                if (!hasTodos) {
                    html += `
                        <div class="empty-todos">
                            <div class="emoji">ğŸ“‹</div>
                            <div>æš‚æ— å¾…åŠäº‹é¡¹</div>
                            <div style="font-size: 13px; margin-top: 8px;">ç‚¹å‡»"å¿«é€Ÿæ·»åŠ å¾…åŠ"å¼€å§‹æ·»åŠ ï¼Œæˆ–ä»ä»Šæ—¥æ—¥å¿—ä¸­æå–</div>
                        </div>
                    `;
                    container.innerHTML = html;
                    return;
                }

                projects.forEach(project => {
                    const projectTodos = todos[project.id] || [];
                    if (projectTodos.length === 0) return;

                    html += renderProjectTodoCard(project, projectTodos);
                });

                container.innerHTML = html;
                return;
            }

            // æ˜¾ç¤ºç‰¹å®šé¡¹ç›®çš„å¾…åŠæ¸…å•
            const project = projects.find(p => p.id === projectId);
            const projectTodos = todos[projectId] || [];

            let html = `<h2 style="margin-bottom: 20px;">âœ… ${project.name} - å¾…åŠæ¸…å•</h2>`;

            if (projectTodos.length === 0) {
                html += `
                    <div class="empty-todos">
                        <div class="emoji">ğŸ“‹</div>
                        <div>è¯¥é¡¹ç›®æš‚æ— å¾…åŠäº‹é¡¹</div>
                        <div style="font-size: 13px; margin-top: 8px;">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æ·»åŠ ç¬¬ä¸€ä¸ªå¾…åŠ</div>
                    </div>
                    <div style="margin-top: 20px;">
                        <button class="btn btn-success" onclick="showAddTodoForm('${projectId}')">â• æ·»åŠ å¾…åŠ</button>
                    </div>
                `;
            } else {
                html += renderProjectTodoCard(project, projectTodos, true);
            }

            container.innerHTML = html;
        }

        // æ¸²æŸ“å•ä¸ªé¡¹ç›®çš„å¾…åŠå¡ç‰‡
        function renderProjectTodoCard(project, projectTodos, showAddButton = false) {
            const pending = projectTodos.filter(t => t.status === 'pending').length;
            const inProgress = projectTodos.filter(t => t.status === 'in-progress').length;
            const completed = projectTodos.filter(t => t.status === 'completed').length;

            let html = `
                <div class="todo-project-card">
                    <div class="todo-project-header" onclick="this.nextElementSibling.style.display = this.nextElementSibling.style.display === 'none' ? 'block' : 'none'">
                        <h3>${project.name}</h3>
                        <div class="todo-project-stats">
                            <span>â³ ${pending}</span>
                            <span>ğŸ”„ ${inProgress}</span>
                            <span>âœ… ${completed}</span>
                        </div>
                    </div>
                    <div class="todo-list">
                        ${projectTodos.map(todo => renderTodoItem(project.id, todo)).join('')}
                        ${showAddButton ? `
                            <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #dee2e6;">
                                <button class="btn btn-success" onclick="showAddTodoForm('${project.id}')" style="font-size: 13px;">â• æ·»åŠ å¾…åŠ</button>
                            </div>
                        ` : ''}
                    </div>
                </div>
            `;
            return html;
        }

        // æ¸²æŸ“å•ä¸ªå¾…åŠäº‹é¡¹
        function renderTodoItem(projectId, todo) {
            const priorityLabels = {
                'high': 'é«˜',
                'medium': 'ä¸­',
                'low': 'ä½'
            };

            const dueDateHtml = todo.dueDate ? `<span class="todo-due-date ${isOverdue(todo.dueDate) && todo.status !== 'completed' ? 'overdue' : ''}">ğŸ“… ${todo.dueDate}</span>` : '';

            return `
                <div class="todo-item ${todo.status === 'completed' ? 'completed' : ''}">
                    <input type="checkbox" class="todo-checkbox" ${todo.status === 'completed' ? 'checked' : ''} onchange="toggleTodoStatus('${projectId}', '${todo.id}')">
                    <div class="todo-content">
                        <span class="todo-text">${escapeHtml(todo.text)}</span>
                        <span class="todo-priority ${todo.priority}">${priorityLabels[todo.priority]}</span>
                        ${dueDateHtml}
                    </div>
                    <div class="todo-actions">
                        <button class="todo-btn" onclick="editTodo('${projectId}', '${todo.id}')" title="ç¼–è¾‘">âœï¸</button>
                        <button class="todo-btn todo-btn-delete" onclick="deleteTodo('${projectId}', '${todo.id}')" title="åˆ é™¤">ğŸ—‘ï¸</button>
                    </div>
                </div>
            `;
        }

        // åˆ¤æ–­æ˜¯å¦è¿‡æœŸ
        function isOverdue(dueDate) {
            const today = new Date().toISOString().split('T')[0];
            return dueDate < today;
        }

        // åˆ‡æ¢å¾…åŠçŠ¶æ€
        function toggleTodoStatus(projectId, todoId) {
            const todos = getTodos();
            const todo = todos[projectId].find(t => t.id === todoId);
            if (todo) {
                todo.status = todo.status === 'completed' ? 'pending' : 'completed';
                saveTodos(todos);
                renderTodosContent();
            }
        }

        // åˆ é™¤å¾…åŠ
        function deleteTodo(projectId, todoId) {
            if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå¾…åŠäº‹é¡¹å—ï¼Ÿ')) return;

            const todos = getTodos();
            todos[projectId] = todos[projectId].filter(t => t.id !== todoId);
            saveTodos(todos);
            renderTodosContent();
        }

        // æ˜¾ç¤ºæ·»åŠ å¾…åŠè¡¨å•
        function showAddTodoForm(projectId) {
            const projects = getProjects();
            const project = projects.find(p => p.id === projectId);

            const formHtml = `
                <div id="addTodoModal" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 1000;">
                    <div style="background: white; border-radius: 12px; padding: 24px; width: 90%; max-width: 500px; box-shadow: 0 10px 40px rgba(0,0,0,0.2);">
                        <h2 style="margin: 0 0 20px 0; font-size: 20px;">â• æ·»åŠ å¾…åŠ - ${project.name}</h2>
                        <div class="form-group">
                            <label>å¾…åŠå†…å®¹ *</label>
                            <input type="text" id="newTodoText" class="form-control" placeholder="è¾“å…¥å¾…åŠäº‹é¡¹..." style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                        </div>
                        <div style="display: flex; gap: 15px; margin-bottom: 15px;">
                            <div class="form-group" style="flex: 1;">
                                <label>ä¼˜å…ˆçº§</label>
                                <select id="newTodoPriority" class="form-control" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                                    <option value="high">ğŸ”´ é«˜ä¼˜å…ˆçº§</option>
                                    <option value="medium" selected>ğŸŸ¡ ä¸­ä¼˜å…ˆçº§</option>
                                    <option value="low">ğŸŸ¢ ä½ä¼˜å…ˆçº§</option>
                                </select>
                            </div>
                            <div class="form-group" style="flex: 1;">
                                <label>æˆªæ­¢æ—¥æœŸ</label>
                                <input type="date" id="newTodoDueDate" class="form-control" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                            </div>
                        </div>
                        <div style="display: flex; gap: 10px; justify-content: flex-end;">
                            <button class="btn btn-primary" onclick="closeAddTodoModal()">å–æ¶ˆ</button>
                            <button class="btn btn-success" onclick="addTodo('${projectId}')">æ·»åŠ </button>
                        </div>
                    </div>
                </div>
            `;

            document.body.insertAdjacentHTML('beforeend', formHtml);
            document.getElementById('newTodoText').focus();
        }

        // å…³é—­æ·»åŠ å¾…åŠè¡¨å•
        function closeAddTodoModal() {
            const modal = document.getElementById('addTodoModal');
            if (modal) modal.remove();
        }

        // æ·»åŠ å¾…åŠ
        function addTodo(projectId) {
            const text = document.getElementById('newTodoText').value.trim();
            const priority = document.getElementById('newTodoPriority').value;
            const dueDate = document.getElementById('newTodoDueDate').value;

            if (!text) {
                alert('è¯·è¾“å…¥å¾…åŠå†…å®¹');
                return;
            }

            const todos = getTodos();
            if (!todos[projectId]) {
                todos[projectId] = [];
            }

            const newTodo = {
                id: Date.now().toString(),
                text: text,
                status: 'pending',
                priority: priority,
                dueDate: dueDate || null,
                createdAt: new Date().toISOString()
            };

            todos[projectId].push(newTodo);
            saveTodos(todos);

            closeAddTodoModal();
            renderTodosContent();
        }

        // ç¼–è¾‘å¾…åŠ
        function editTodo(projectId, todoId) {
            const todos = getTodos();
            const todo = todos[projectId].find(t => t.id === todoId);
            if (!todo) return;

            const formHtml = `
                <div id="editTodoModal" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 1000;">
                    <div style="background: white; border-radius: 12px; padding: 24px; width: 90%; max-width: 500px; box-shadow: 0 10px 40px rgba(0,0,0,0.2);">
                        <h2 style="margin: 0 0 20px 0; font-size: 20px;">âœï¸ ç¼–è¾‘å¾…åŠ</h2>
                        <div class="form-group">
                            <label>å¾…åŠå†…å®¹ *</label>
                            <input type="text" id="editTodoText" class="form-control" value="${escapeHtml(todo.text)}" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                        </div>
                        <div style="display: flex; gap: 15px; margin-bottom: 15px;">
                            <div class="form-group" style="flex: 1;">
                                <label>ä¼˜å…ˆçº§</label>
                                <select id="editTodoPriority" class="form-control" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                                    <option value="high" ${todo.priority === 'high' ? 'selected' : ''}>ğŸ”´ é«˜ä¼˜å…ˆçº§</option>
                                    <option value="medium" ${todo.priority === 'medium' ? 'selected' : ''}>ğŸŸ¡ ä¸­ä¼˜å…ˆçº§</option>
                                    <option value="low" ${todo.priority === 'low' ? 'selected' : ''}>ğŸŸ¢ ä½ä¼˜å…ˆçº§</option>
                                </select>
                            </div>
                            <div class="form-group" style="flex: 1;">
                                <label>çŠ¶æ€</label>
                                <select id="editTodoStatus" class="form-control" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                                    <option value="pending" ${todo.status === 'pending' ? 'selected' : ''}>â³ å¾…å¼€å§‹</option>
                                    <option value="in-progress" ${todo.status === 'in-progress' ? 'selected' : ''}>ğŸ”„ è¿›è¡Œä¸­</option>
                                    <option value="completed" ${todo.status === 'completed' ? 'selected' : ''}>âœ… å·²å®Œæˆ</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>æˆªæ­¢æ—¥æœŸ</label>
                            <input type="date" id="editTodoDueDate" class="form-control" value="${todo.dueDate || ''}" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                        </div>
                        <div style="display: flex; gap: 10px; justify-items: flex-end;">
                            <button class="btn btn-primary" onclick="closeEditTodoModal()">å–æ¶ˆ</button>
                            <button class="btn btn-success" onclick="saveTodoEdit('${projectId}', '${todoId}')">ä¿å­˜</button>
                        </div>
                    </div>
                </div>
            `;

            document.body.insertAdjacentHTML('beforeend', formHtml);
            document.getElementById('editTodoText').focus();
        }

        // å…³é—­ç¼–è¾‘å¾…åŠè¡¨å•
        function closeEditTodoModal() {
            const modal = document.getElementById('editTodoModal');
            if (modal) modal.remove();
        }

        // ä¿å­˜å¾…åŠç¼–è¾‘
        function saveTodoEdit(projectId, todoId) {
            const text = document.getElementById('editTodoText').value.trim();
            const priority = document.getElementById('editTodoPriority').value;
            const status = document.getElementById('editTodoStatus').value;
            const dueDate = document.getElementById('editTodoDueDate').value;

            if (!text) {
                alert('è¯·è¾“å…¥å¾…åŠå†…å®¹');
                return;
            }

            const todos = getTodos();
            const todo = todos[projectId].find(t => t.id === todoId);
            if (todo) {
                todo.text = text;
                todo.priority = priority;
                todo.status = status;
                todo.dueDate = dueDate || null;
                saveTodos(todos);
            }

            closeEditTodoModal();
            renderTodosContent();
        }

        // ä»ä»Šæ—¥æ—¥å¿—æå–å¾…åŠäº‹é¡¹
        function extractTodosFromTodayLog() {
            const logs = getLogs();
            const todos = getTodos();
            const projects = getProjects();
            const today = new Date().toISOString().split('T')[0];

            // è·å–ä»Šå¤©çš„æ—¥å¿—
            const todayLogs = logs.filter(log => log.date === today);

            if (todayLogs.length === 0) {
                alert('ä»Šå¤©è¿˜æ²¡æœ‰å·¥ä½œæ—¥å¿—ï¼Œè¯·å…ˆæ·»åŠ æ—¥å¿—å†æå–å¾…åŠäº‹é¡¹ã€‚');
                return;
            }

            let extractedCount = 0;
            const extractedByProject = {};

            // å¾…åŠäº‹é¡¹å…³é”®è¯ï¼ˆä¸­æ–‡å’Œè‹±æ–‡ï¼‰
            const todoKeywords = [
                'å¾…åŠ', 'å¾…åš', 'æœªå®Œæˆ', 'TODO', 'todo', 'å¾…å®Œæˆ',
                'éœ€è¦', 'è¿˜éœ€', 'ç»§ç»­', 'è·Ÿè¿›', 'å¤„ç†',
                'è§£å†³', 'ä¿®å¤', 'ä¼˜åŒ–', 'æ·»åŠ ', 'å®ç°'
            ];

            todayLogs.forEach(log => {
                if (!log.items || log.items.length === 0) return;

                // è·å–é¡¹ç›®åç§°
                const project = projects.find(p => p.id === log.projectId);
                const projectName = project ? project.name : log.projectName || 'æœªçŸ¥é¡¹ç›®';

                // ç¡®ä¿è¯¥é¡¹ç›®æœ‰å¾…åŠæ•°ç»„
                if (!todos[log.projectId]) {
                    todos[log.projectId] = [];
                }

                // åˆå§‹åŒ–è¯¥é¡¹ç›®è®¡æ•°
                if (!extractedByProject[log.projectId]) {
                    extractedByProject[log.projectId] = { name: projectName, count: 0 };
                }

                log.items.forEach(item => {
                    const trimmedItem = item.trim();

                    // è·³è¿‡å·²å®Œæˆçš„é¡¹ç›®ï¼ˆä»¥âœ…å¼€å¤´çš„ï¼‰
                    if (trimmedItem.startsWith('âœ…') || trimmedItem.startsWith('å®Œæˆ')) {
                        return;
                    }

                    // æ£€æŸ¥æ˜¯å¦åŒ…å«å¾…åŠå…³é”®è¯
                    const hasTodoKeyword = todoKeywords.some(keyword =>
                        trimmedItem.toLowerCase().includes(keyword.toLowerCase())
                    );

                    if (hasTodoKeyword) {
                        // æ¸…ç†æ–‡æœ¬ï¼Œç§»é™¤ç¬¦å·
                        let cleanText = trimmedItem
                            .replace(/^[â– â—â–ªÂ·-]\s*/, '')  // ç§»é™¤å¼€å¤´çš„é¡¹ç›®ç¬¦å·
                            .replace(/^(å¾…åŠ|TODO|todo):?\s*/i, '')  // ç§»é™¤å¾…åŠæ ‡è®°
                            .trim();

                        // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨ç›¸åŒçš„å¾…åŠ
                        const exists = todos[log.projectId].some(t =>
                            t.text === cleanText || t.text === trimmedItem
                        );

                        if (!exists && cleanText.length > 0) {
                            // æ ¹æ®å…³é”®è¯åˆ¤æ–­ä¼˜å…ˆçº§
                            let priority = 'medium';
                            if (cleanText.includes('ç´§æ€¥') || cleanText.includes('é‡è¦') || cleanText.includes('!!!')) {
                                priority = 'high';
                            } else if (cleanText.includes('ä¼˜åŒ–') || cleanText.includes('æ”¹è¿›')) {
                                priority = 'low';
                            }

                            const newTodo = {
                                id: Date.now().toString() + Math.random().toString(36).substr(2, 9),
                                text: cleanText,
                                status: 'pending',
                                priority: priority,
                                dueDate: null,
                                createdAt: new Date().toISOString(),
                                source: 'today-log'
                            };

                            todos[log.projectId].push(newTodo);
                            extractedCount++;
                            extractedByProject[log.projectId].count++;
                        }
                    }
                });
            });

            if (extractedCount === 0) {
                alert('ä»Šå¤©çš„æ—¥å¿—ä¸­æ²¡æœ‰æ‰¾åˆ°å¾…åŠäº‹é¡¹ã€‚\n\næç¤ºï¼šæ—¥å¿—ä¸­åŒ…å«"å¾…åŠ"ã€"æœªå®Œæˆ"ã€"éœ€è¦"ã€"ç»§ç»­"ç­‰å…³é”®è¯çš„å†…å®¹ä¼šè¢«è¯†åˆ«ä¸ºå¾…åŠäº‹é¡¹ã€‚');
                return;
            }

            saveTodos(todos);
            renderTodosContent();

            // æ„å»ºè¯¦ç»†çš„æ¶ˆæ¯
            let message = `âœ… æˆåŠŸä»ä»Šæ—¥æ—¥å¿—æå–äº† ${extractedCount} ä¸ªå¾…åŠäº‹é¡¹ï¼\n\n`;
            Object.values(extractedByProject).forEach(({ name, count }) => {
                message += `â€¢ ${name}: ${count} ä¸ª\n`;
            });

            alert(message);
        }

        // æ˜¾ç¤ºå¿«é€Ÿæ·»åŠ å¾…åŠè¡¨å•
        function showQuickAddTodo() {
            const form = document.getElementById('quickAddTodoForm');
            form.style.display = 'block';
            document.getElementById('quickTodoText').focus();
        }

        // éšè—å¿«é€Ÿæ·»åŠ å¾…åŠè¡¨å•
        function hideQuickAddTodo() {
            const form = document.getElementById('quickAddTodoForm');
            form.style.display = 'none';
            document.getElementById('quickTodoText').value = '';
            document.getElementById('quickTodoDueDate').value = '';
            document.getElementById('quickTodoProject').value = '';
        }

        // å¿«é€Ÿæ·»åŠ å¾…åŠ
        function quickAddTodo() {
            const projectId = document.getElementById('quickTodoProject').value;
            const text = document.getElementById('quickTodoText').value.trim();
            const priority = document.getElementById('quickTodoPriority').value;
            const dueDate = document.getElementById('quickTodoDueDate').value;

            if (!projectId) {
                alert('è¯·é€‰æ‹©é¡¹ç›®');
                return;
            }

            if (!text) {
                alert('è¯·è¾“å…¥å¾…åŠå†…å®¹');
                return;
            }

            const projects = getProjects();
            const project = projects.find(p => p.id === projectId);
            const projectName = project ? project.name : 'æœªçŸ¥é¡¹ç›®';

            const todos = getTodos();
            if (!todos[projectId]) {
                todos[projectId] = [];
            }

            // æ”¯æŒæ‰¹é‡æ·»åŠ ï¼ˆæ¯è¡Œä¸€ä¸ªï¼‰
            const lines = text.split('\n').filter(line => line.trim());
            let addedCount = 0;

            lines.forEach(line => {
                const cleanText = line.trim();
                if (cleanText) {
                    const newTodo = {
                        id: Date.now().toString() + Math.random().toString(36).substr(2, 9),
                        text: cleanText,
                        status: 'pending',
                        priority: priority,
                        dueDate: dueDate || null,
                        createdAt: new Date().toISOString()
                    };
                    todos[projectId].push(newTodo);
                    addedCount++;
                }
            });

            saveTodos(todos);

            // æ¸…ç©ºè¡¨å•ä½†ä¿æŒå±•å¼€ï¼Œæ–¹ä¾¿ç»§ç»­æ·»åŠ 
            document.getElementById('quickTodoText').value = '';

            renderTodosContent();

            // é‡æ–°æ˜¾ç¤ºè¡¨å•
            setTimeout(() => {
                showQuickAddTodo();
            }, 100);

            // æ˜¾ç¤ºæ·»åŠ æˆåŠŸæç¤ºï¼ˆåŒ…å«é¡¹ç›®åç§°ï¼‰
            if (addedCount > 0) {
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: #4CAF50;
                    color: white;
                    padding: 12px 24px;
                    border-radius: 8px;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                    z-index: 10000;
                    font-size: 14px;
                    animation: slideIn 0.3s ease-out;
                `;
                notification.textContent = `âœ… å·²ä¸ºã€Œ${projectName}ã€æ·»åŠ  ${addedCount} ä¸ªå¾…åŠäº‹é¡¹ï¼`;
                document.body.appendChild(notification);

                setTimeout(() => {
                    notification.style.animation = 'slideOut 0.3s ease-out';
                    setTimeout(() => notification.remove(), 300);
                }, 2000);
            }
        }

        // è‡ªåŠ¨åˆ›å»ºä»Šæ—¥æ€»ç»“
        function autoCreateTodaySummary() {
            const logs = getLogs();
            const today = new Date().toISOString().split('T')[0];

            // æ£€æŸ¥ä»Šå¤©æ˜¯å¦å·²æœ‰æ—¥å¿—
            const hasTodayLog = logs.some(log => log.date === today);

            if (!hasTodayLog) {
                const todayLog = {
                    id: Date.now().toString(),
                    projectId: 'english-learning-tts',
                    projectName: 'è‹±è¯­å­¦ä¹  TTS ç³»ç»Ÿ',
                    date: today,
                    datetime: new Date().toLocaleString('zh-CN'),
                    title: 'ğŸ“š ä»Šæ—¥å·¥ä½œæ€»ç»“',
                    tags: [{ name: 'ğŸ”§ ä¿®å¤', type: 'fix' }],
                    items: [
                        'âœ… ä¿®å¤ TTS é˜Ÿåˆ—ç­–ç•¥é—®é¢˜ - è§£å†³æµè§ˆå™¨è‡ªåŠ¨æ’­æ”¾ç­–ç•¥å¯¼è‡´çš„ not-allowed é”™è¯¯',
                        'âœ… åˆ›å»ºé¡¹ç›®æ—¥å¿—ç³»ç»Ÿ - æŒ‰é¡¹ç›®å’Œæ—¥æœŸç»„ç»‡å·¥ä½œæ€»ç»“',
                        'âœ… åˆ›å»ºé¡¹ç›®ç»éªŒæ€»ç»“æ–‡æ¡£ - æ±‡æ€»9å¤§è¸©å‘å’Œæœ€ä½³å®è·µ',
                        'âœ… åˆ›å»ºæ¡Œé¢å¿«æ·æ–¹å¼ - æ–¹ä¾¿å¿«é€Ÿè®¿é—®ç³»ç»Ÿ'
                    ],
                    code: null
                };

                logs.unshift(todayLog);
                saveLogs(logs);
                console.log('âœ… ä»Šæ—¥æ€»ç»“å·²è‡ªåŠ¨åˆ›å»º');
            }
        }

        // æ‰‹åŠ¨è§¦å‘å†å²æ—¥å¿—ç”Ÿæˆï¼ˆç”¨æˆ·æŒ‰é’®è°ƒç”¨ï¼‰
        function manualGenerateHistoricalLogs() {
            const days = prompt('è¯·è¾“å…¥è¦æ£€æŸ¥çš„å¤©æ•°ï¼ˆé»˜è®¤7å¤©ï¼Œæœ€å¤š30å¤©ï¼‰ï¼š', '7');
            const daysToCheck = Math.min(Math.max(parseInt(days) || 7, 1), 30);

            if (isNaN(daysToCheck)) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„æ•°å­—');
                return;
            }

            const filledDays = generateHistoricalLogs(daysToCheck);

            if (filledDays > 0) {
                alert(`âœ… æˆåŠŸç”Ÿæˆ ${filledDays} æ¡å†å²æ—¥å¿—ï¼\n\nç³»ç»Ÿå·²ä¸ºæœ€è¿‘ ${daysToCheck} å¤©ä¸­ç¼ºå¤±çš„æ—¥æœŸåˆ›å»ºäº†æ—¥å¿—æ¨¡æ¿ã€‚`);
                renderAll();
            } else {
                alert(`â„¹ï¸ æœ€è¿‘ ${daysToCheck} å¤©çš„æ—¥å¿—å·²å®Œæ•´ï¼Œæ— éœ€è¡¥å……ã€‚`);
            }
        }

        // è‡ªåŠ¨ç”Ÿæˆå†å²æ—¥å¿—ï¼ˆå¡«è¡¥ç©ºç¼ºæ—¥æœŸï¼‰
        function generateHistoricalLogs(daysToCheck = 7) {
            const logs = getLogs();
            const projects = getProjects();

            if (projects.length === 0) {
                console.log('âš ï¸ æ²¡æœ‰é¡¹ç›®é…ç½®ï¼Œè·³è¿‡å†å²æ—¥å¿—ç”Ÿæˆ');
                return;
            }

            // è·å–å·²æœ‰æ—¥å¿—çš„æ—¥æœŸé›†åˆ
            const existingDates = new Set(logs.map(log => log.date));

            // è·å–ä»Šå¤©çš„æ—¥æœŸ
            const today = new Date();
            today.setHours(0, 0, 0, 0);

            // é»˜è®¤é¡¹ç›®ï¼ˆä½¿ç”¨ç¬¬ä¸€ä¸ªé¡¹ç›®æˆ–æœ€å¸¸è§çš„é¡¹ç›®ï¼‰
            const defaultProject = projects[0];

            // ç”Ÿæˆæ¨¡æ¿å†…å®¹é€‰é¡¹
            const templateOptions = {
                items: [
                    'ğŸ“‹ æŸ¥çœ‹é¡¹ç›®è¿›åº¦å’Œå¾…åŠäº‹é¡¹',
                    'ğŸ” åˆ†æä»£ç é—®é¢˜å¹¶åˆ¶å®šè§£å†³æ–¹æ¡ˆ',
                    'âœ¨ å®ŒæˆåŠŸèƒ½å¼€å‘',
                    'ğŸ› ä¿®å¤å·²çŸ¥é—®é¢˜',
                    'ğŸ“š å­¦ä¹ æ–°æŠ€æœ¯å’Œæœ€ä½³å®è·µ',
                    'ğŸ“ ç¼–å†™æŠ€æœ¯æ–‡æ¡£',
                    'ğŸ’¬ å›¢é˜Ÿæ²Ÿé€šå’Œåä½œ',
                    'ğŸ¯ è§„åˆ’ä¸‹ä¸€æ­¥å·¥ä½œ'
                ],
                titles: [
                    'ğŸ’¼ æ—¥å¸¸å·¥ä½œè®°å½•',
                    'ğŸš€ åŠŸèƒ½å¼€å‘è¿›åº¦',
                    'ğŸ”§ é—®é¢˜ä¿®å¤ä¸ä¼˜åŒ–',
                    'ğŸ“š å­¦ä¹ ä¸ç ”ç©¶',
                    'ğŸ¯ é¡¹ç›®æ¨è¿›'
                ],
                tags: [
                    { name: 'ğŸš€ å¼€å‘', type: 'feature' },
                    { name: 'ğŸ”§ ä¿®å¤', type: 'fix' },
                    { name: 'ğŸ“š å­¦ä¹ ', type: 'learning' },
                    { name: 'ğŸ” åˆ†æ', type: 'analysis' },
                    { name: 'âœ¨ ä¼˜åŒ–', type: 'improvement' }
                ]
            };

            let generatedCount = 0;
            const newLogs = [];

            // æ£€æŸ¥å‰å‡ å¤©ï¼ˆä¸åŒ…æ‹¬ä»Šå¤©ï¼‰
            for (let i = 1; i <= daysToCheck; i++) {
                const checkDate = new Date(today);
                checkDate.setDate(checkDate.getDate() - i);
                const dateStr = checkDate.toISOString().split('T')[0];

                // å¦‚æœè¿™å¤©æ²¡æœ‰æ—¥å¿—ï¼Œåˆ›å»ºä¸€ä¸ªæ¨¡æ¿
                if (!existingDates.has(dateStr)) {
                    // éšæœºé€‰æ‹©æ¨¡æ¿å†…å®¹
                    const randomTitle = templateOptions.titles[Math.floor(Math.random() * templateOptions.titles.length)];
                    const randomTag = templateOptions.tags[Math.floor(Math.random() * templateOptions.tags.length)];

                    // éšæœºé€‰æ‹©2-4ä¸ªå·¥ä½œäº‹é¡¹
                    const shuffledItems = [...templateOptions.items].sort(() => 0.5 - Math.random());
                    const selectedItems = shuffledItems.slice(0, Math.floor(Math.random() * 3) + 2);

                    const templateLog = {
                        id: (Date.now() - i * 1000).toString(),
                        projectId: defaultProject.id,
                        projectName: defaultProject.name,
                        date: dateStr,
                        datetime: new Date(checkDate).toLocaleString('zh-CN'),
                        title: randomTitle,
                        tags: [randomTag],
                        items: selectedItems,
                        code: null,
                        isAutoGenerated: true // æ ‡è®°ä¸ºè‡ªåŠ¨ç”Ÿæˆ
                    };

                    newLogs.push(templateLog);
                    generatedCount++;
                }
            }

            // å¦‚æœæœ‰ç”Ÿæˆçš„æ–°æ—¥å¿—ï¼Œä¿å­˜åˆ°localStorage
            if (newLogs.length > 0) {
                // åˆå¹¶ç°æœ‰æ—¥å¿—å’Œæ–°æ—¥å¿—ï¼ŒæŒ‰æ—¥æœŸæ’åº
                const allLogs = [...newLogs, ...logs];
                allLogs.sort((a, b) => new Date(b.date) - new Date(a.date));
                saveLogs(allLogs);
                console.log(`âœ… å·²è‡ªåŠ¨ç”Ÿæˆ ${generatedCount} æ¡å†å²æ—¥å¿—ï¼ˆæœ€è¿‘ ${daysToCheck} å¤©ï¼‰`);
            } else {
                console.log('â„¹ï¸ å†å²æ—¥å¿—å®Œæ•´ï¼Œæ— éœ€è¡¥å……');
            }

            return generatedCount;
        }

        // åˆå§‹åŒ–
        window.addEventListener('DOMContentLoaded', () => {
            initProjects();
            document.getElementById('logDate').value = new Date().toISOString().split('T')[0];

            // è‡ªåŠ¨ç”Ÿæˆå†å²è®°å½•ï¼ˆé¦–æ¬¡è¿è¡Œæ—¶ï¼ŒåŸºäºçœŸå®æ–‡ä»¶å†…å®¹ï¼‰
            generateProjectHistory();

            // æ¸²æŸ“é¡¹ç›®åˆ—è¡¨
            renderProjectList();

            // æ›´æ–°é¡¹ç›®é€‰æ‹©å™¨
            updateProjectSelector();

            renderAll();

            // æ¸²æŸ“å¾…åŠæ¸…å•ï¼ˆé»˜è®¤tabï¼‰
            renderTodosContent();

            // æ˜¾ç¤ºæ¬¢è¿å¼•å¯¼ï¼ˆå¦‚æœæ˜¯é¦–æ¬¡ä½¿ç”¨ï¼‰
            const logs = getLogs();
            if (logs.length > 0 && !localStorage.getItem('guide_dismissed')) {
                document.getElementById('welcomeGuide').style.display = 'block';
            }

            // ç›‘å¬é¡¹ç›®é€‰æ‹©
            document.getElementById('projectSelect').addEventListener('change', (e) => {
                document.getElementById('otherProjectGroup').style.display =
                    e.target.value === 'other' ? 'block' : 'none';
            });
        });

        function initProjects() {
            const projects = localStorage.getItem(PROJECTS_KEY);
            if (!projects) {
                localStorage.setItem(PROJECTS_KEY, JSON.stringify(defaultProjects));
            }
        }

        function getProjects() {
            return JSON.parse(localStorage.getItem(PROJECTS_KEY) || '[]');
        }

        function getLogs() {
            return JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
        }

        function getTodos() {
            return JSON.parse(localStorage.getItem(TODOS_KEY) || '{}');
        }

        function saveTodos(todos) {
            localStorage.setItem(TODOS_KEY, JSON.stringify(todos));
        }

        function saveLogs(logs) {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(logs));
            // è‡ªåŠ¨ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶
            autoSaveToFile(logs);
        }

        async function autoSaveToFile(logs) {
            const data = {
                version: '1.0',
                exportTime: new Date().toISOString(),
                logs: logs,
                projects: getProjects()
            };

            // å¦‚æœå·²æœ‰æ–‡ä»¶å¥æŸ„ï¼Œç›´æ¥å†™å…¥ï¼ˆé™é»˜ä¿å­˜ï¼‰
            if (fileHandle) {
                try {
                    const writable = await fileHandle.createWritable();
                    await writable.write(JSON.stringify(data, null, 2));
                    await writable.close();
                    console.log('âœ… æ•°æ®å·²è‡ªåŠ¨ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶');
                    // åœ¨é¡µé¢æ˜¾ç¤ºä¿å­˜æˆåŠŸæç¤º
                    showSaveNotification();
                    return;
                } catch (err) {
                    console.error('ä¿å­˜å¤±è´¥:', err);
                    fileHandle = null; // é‡ç½®æ–‡ä»¶å¥æŸ„
                }
            }

            // é¦–æ¬¡ä¿å­˜ï¼Œé™é»˜è¯·æ±‚ç”¨æˆ·é€‰æ‹©æ–‡ä»¶ä½ç½®ï¼ˆä¸é˜»å¡ï¼‰
            requestFileSavePermission(data);
        }

        function showSaveNotification() {
            // åœ¨é¡µé¢é¡¶éƒ¨æ˜¾ç¤ºä¿å­˜æˆåŠŸæç¤º
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #4CAF50;
                color: white;
                padding: 12px 24px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 10000;
                font-size: 14px;
                animation: slideIn 0.3s ease-out;
            `;
            notification.textContent = 'âœ… å·²è‡ªåŠ¨ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶';
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease-out';
                setTimeout(() => notification.remove(), 300);
            }, 2000);
        }

        async function requestFileSavePermission(data) {
            // å»¶è¿Ÿæ‰§è¡Œï¼Œä¸é˜»å¡å½“å‰æ“ä½œ
            setTimeout(async () => {
                try {
                    fileHandle = await window.showSaveFilePicker({
                        suggestedName: `project-log-data-${new Date().toISOString().split('T')[0]}.json`,
                        types: [{
                            description: 'JSON æ–‡ä»¶',
                            accept: {'application/json': ['.json']},
                        }],
                    });

                    const writable = await fileHandle.createWritable();
                    await writable.write(JSON.stringify(data, null, 2));
                    await writable.close();
                    console.log('âœ… æ•°æ®å·²ä¿å­˜ï¼Œåç»­å°†è‡ªåŠ¨æ›´æ–°æ­¤æ–‡ä»¶');
                } catch (err) {
                    // ç”¨æˆ·å–æ¶ˆäº†é€‰æ‹©æ–‡ä»¶ï¼Œè¿™æ˜¯æ­£å¸¸çš„
                    if (err.name !== 'AbortError') {
                        console.error('ä¿å­˜æ–‡ä»¶å¤±è´¥:', err);
                    }
                }
            }, 100);
        }

        async function loadDataFile() {
            try {
                // è®©ç”¨æˆ·é€‰æ‹©æ•°æ®æ–‡ä»¶
                const [handle] = await window.showOpenFilePicker({
                    types: [{
                        description: 'JSON æ–‡ä»¶',
                        accept: {'application/json': ['.json']},
                    }],
                    multiple: false,
                });

                // ä¿å­˜æ–‡ä»¶å¥æŸ„ï¼Œç”¨äºåç»­è‡ªåŠ¨ä¿å­˜
                fileHandle = handle;

                // è¯»å–æ–‡ä»¶å†…å®¹
                const file = await handle.getFile();
                const text = await file.text();
                const data = JSON.parse(text);

                // åŠ è½½æ•°æ®åˆ° localStorage
                if (data.logs && Array.isArray(data.logs)) {
                    localStorage.setItem(STORAGE_KEY, JSON.stringify(data.logs));
                    if (data.projects && Array.isArray(data.projects)) {
                        localStorage.setItem(PROJECTS_KEY, JSON.stringify(data.projects));
                    }
                    alert(`âœ… å·²åŠ è½½ ${data.logs.length} æ¡æ—¥å¿—ï¼\nåç»­ä¿å­˜å°†è‡ªåŠ¨æ›´æ–°æ­¤æ–‡ä»¶ã€‚`);
                    renderAll();
                } else {
                    alert('âŒ æ–‡ä»¶æ ¼å¼ä¸æ­£ç¡®');
                }
            } catch (err) {
                if (err.name !== 'AbortError') {
                    alert('âŒ æ‰“å¼€æ–‡ä»¶å¤±è´¥ï¼š' + err.message);
                }
            }
        }

        // æ™ºèƒ½ç”Ÿæˆä»Šæ—¥æ—¥å¿—ï¼ˆåŸºäºGitå˜æ›´ï¼‰
        async function autoGenerateTodayLog() {
            const today = new Date().toISOString().split('T')[0];
            const logs = getLogs();

            // æ£€æŸ¥ä»Šå¤©æ˜¯å¦å·²æœ‰æ—¥å¿—
            const hasTodayLog = logs.some(log => log.date === today);

            if (hasTodayLog) {
                alert('ä»Šå¤©å·²ç»åˆ›å»ºè¿‡æ—¥å¿—äº†ï¼\n\nä½ å¯ä»¥ï¼š\n1. åœ¨ç°æœ‰æ—¥å¿—åŸºç¡€ä¸Šæ·»åŠ å†…å®¹\n2. æˆ–æ‰‹åŠ¨åˆ›å»ºæ–°çš„æ—¥å¿—æ¡ç›®');
                return;
            }

            // è°ƒç”¨åç«¯è„šæœ¬è·å–Gitå˜æ›´
            try {
                const response = await fetch('/api/auto-generate-log', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ today: today })
                });

                if (response.ok) {
                    const data = await response.json();

                    if (data.logs && data.logs.length > 0) {
                        // æ·»åŠ ç”Ÿæˆçš„æ—¥å¿—
                        data.logs.forEach(log => {
                            logs.unshift(log);
                        });
                        saveLogs(logs);
                        renderAll();

                        alert(`âœ… å·²è‡ªåŠ¨ç”Ÿæˆ ${data.logs.length} æ¡æ—¥å¿—ï¼\n\nåŸºäºä»¥ä¸‹é¡¹ç›®çš„Gitå˜æ›´ï¼š\n${data.projects.join('\n')}`);
                    } else {
                        // æ²¡æœ‰Gitå˜æ›´ï¼Œæ˜¾ç¤ºæç¤º
                        const result = confirm('ğŸ¤– æ™ºèƒ½ç”Ÿæˆä»Šæ—¥æ—¥å¿—\n\nä»Šå¤©æ²¡æœ‰æ£€æµ‹åˆ°Gitæäº¤è®°å½•ã€‚\n\næ˜¯å¦è¦åˆ›å»ºä¸€ä¸ªç©ºç™½æ—¥å¿—æ¨¡æ¿ï¼Ÿ');
                        if (result) {
                            showAddForm();
                        }
                    }
                } else {
                    throw new Error('APIè¯·æ±‚å¤±è´¥');
                }
            } catch (error) {
                // APIä¸å¯ç”¨ï¼Œæä¾›æ‰‹åŠ¨å¼•å¯¼
                const result = confirm('ğŸ¤– æ™ºèƒ½ç”Ÿæˆä»Šæ—¥æ—¥å¿—\n\nè‡ªåŠ¨æ£€æµ‹åŠŸèƒ½éœ€è¦åç«¯APIæ”¯æŒã€‚\n\nç‚¹å‡»"ç¡®å®š"æŸ¥çœ‹æ‰‹åŠ¨åˆ›å»ºæŒ‡å—ï¼Œæˆ–"å–æ¶ˆ"ç›´æ¥åˆ›å»ºæ—¥å¿—ã€‚');
                if (result) {
                    window.open('daily-reports/' + today + '.md', '_blank');
                } else {
                    showAddForm();
                }
            }
        }

        function showAddForm() {
            document.getElementById('addForm').classList.add('active');
        }

        function hideAddForm() {
            document.getElementById('addForm').classList.remove('active');
        }

        function saveLogForm() {
            const projects = getProjects();
            const projectSelect = document.getElementById('projectSelect').value;
            let projectName;

            if (projectSelect === 'other') {
                projectName = document.getElementById('otherProjectName').value.trim();
                if (!projectName) {
                    alert('è¯·è¾“å…¥é¡¹ç›®åç§°');
                    return;
                }
            } else {
                const project = projects.find(p => p.id === projectSelect);
                projectName = project.name;
            }

            const date = document.getElementById('logDate').value;
            const type = document.getElementById('logType').value;
            const items = document.getElementById('logItems').value.split('\n').filter(i => i.trim());
            const code = document.getElementById('logCode').value.trim();

            if (items.length === 0) {
                alert('è¯·å¡«å†™é¡¹ç›®æ€»ç»“æ—¥å¿—');
                return;
            }

            const typeTags = {
                'feature': { name: 'âœ¨ æ–°åŠŸèƒ½', type: 'feature' },
                'fix': { name: 'ğŸ”§ ä¿®å¤', type: 'fix' },
                'improvement': { name: 'ğŸš€ ä¼˜åŒ–', type: 'improvement' },
                'learning': { name: 'ğŸ“š å­¦ä¹ ', type: 'learning' }
            };

            const log = {
                id: Date.now().toString(),
                projectId: projectSelect,
                projectName: projectName,
                date: date,
                datetime: new Date().toLocaleString('zh-CN'),
                title: `${typeTags[type].name} - ${date}`,
                tags: [{ ...typeTags[type] }],
                items: items,
                code: code || null
            };

            const logs = getLogs();
            logs.unshift(log);
            saveLogs(logs);

            alert('âœ… æ—¥å¿—å·²ä¿å­˜ï¼');
            hideAddForm();
            renderAll();
        }

        function renderAll() {
            const logs = getLogs();

            // æ ¹æ®å½“å‰ç­›é€‰çš„é¡¹ç›®è¿‡æ»¤æ—¥å¿—
            let filteredLogs = logs;
            if (currentProjectFilter !== null) {
                filteredLogs = logs.filter(log => log.projectId === currentProjectFilter);
            }

            renderStats(logs); // ç»Ÿè®¡æ˜¾ç¤ºå…¨éƒ¨æ•°æ®
            renderTable(filteredLogs); // è¡¨æ ¼æ˜¾ç¤ºç­›é€‰åçš„æ•°æ®
        }

        function renderStats(logs) {
            const projects = getProjects();
            const dates = [...new Set(logs.map(l => l.date.split('T')[0]))];

            document.getElementById('stats').innerHTML = `
                <div class="stat-card">
                    <div class="stat-value">${logs.length}</div>
                    <div class="stat-label">æ€»æ—¥å¿—æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${dates.length}</div>
                    <div class="stat-label">æ´»è·ƒå¤©æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${projects.length}</div>
                    <div class="stat-label">é¡¹ç›®æ•°</div>
                </div>
            `;
        }

        function renderTable(logs) {
            const container = document.getElementById('logTable');

            if (logs.length === 0) {
                container.innerHTML = '<div class="empty-state">æš‚æ— æ—¥å¿—è®°å½•<br><button class="btn btn-primary" onclick="showAddForm()">æ·»åŠ ç¬¬ä¸€æ¡æ—¥å¿—</button></div>';
                return;
            }

            const tagClass = {
                'feature': 'tag-feature',
                'fix': 'tag-fix',
                'improvement': 'tag-improvement',
                'learning': 'tag-learning'
            };

            container.innerHTML = `
                <table>
                    <thead>
                        <tr>
                            <th style="width: 200px;">é¡¹ç›®åç§°</th>
                            <th style="width: 150px;">æ—¥æœŸ</th>
                            <th>é¡¹ç›®æ€»ç»“æ—¥å¿—</th>
                            <th style="width: 100px;">ç±»å‹</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${logs.map(log => `
                            <tr ${log.isAutoGenerated ? 'style="background: rgba(92, 124, 250, 0.05);"' : ''}>
                                <td>
                                    <span class="project-name">${log.projectName}</span>
                                    ${log.isAutoGenerated ? '<span style="display: inline-block; margin-left: 6px; padding: 2px 6px; font-size: 11px; background: rgba(92, 124, 250, 0.15); color: #5c7cfa; border-radius: 4px;">è‡ªåŠ¨ç”Ÿæˆ</span>' : ''}
                                </td>
                                <td><span class="log-date">${log.date}</span></td>
                                <td class="log-summary" ${log.isAutoGenerated ? 'style="opacity: 0.75;"' : ''}>
                                    ${log.items.map(item => `<div>${item}</div>`).join('')}
                                    ${log.code ? `<pre style="margin-top: 10px; background: #1a1a1a; color: #aed581; padding: 10px; border-radius: 4px; overflow-x: auto;">${escapeHtml(log.code)}</pre>` : ''}
                                </td>
                                <td>
                                    ${log.tags.map(tag => `<span class="tag ${tagClass[tag.type]}">${tag.name}</span>`).join('')}
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        // åˆ·æ–°æ‰€æœ‰æ•°æ®
        function refreshAllData() {
            // æ˜¾ç¤ºåˆ·æ–°æç¤º
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #5c7cfa;
                color: white;
                padding: 12px 24px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 10000;
                font-size: 14px;
                animation: slideIn 0.3s ease-out;
            `;
            notification.textContent = 'ğŸ”„ æ­£åœ¨åˆ·æ–°æ•°æ®...';
            document.body.appendChild(notification);

            // é‡æ–°åˆå§‹åŒ–é¡¹ç›®æ•°æ®
            initProjects();

            // é‡æ–°æ¸²æŸ“æ‰€æœ‰å†…å®¹
            renderProjectList();
            updateProjectSelector();
            renderAll();

            // é‡æ–°æ¸²æŸ“å½“å‰æ ‡ç­¾é¡µå†…å®¹
            const activeTabBtn = document.querySelector('.tab-btn.active');
            if (activeTabBtn) {
                const tabText = activeTabBtn.textContent;
                if (tabText.includes('ğŸ“š é¡¹ç›®ç»éªŒæ€»ç»“')) {
                    renderSummaryContent();
                } else if (tabText.includes('ğŸ”— é¡¹ç›®é“¾æ¥æ±‡æ€»')) {
                    renderLinksContent();
                } else if (tabText.includes('âœ… å¾…åŠæ¸…å•')) {
                    renderTodosContent();
                } else if (tabText.includes('ğŸ” é¡¹ç›®æ£€æŸ¥')) {
                    runProjectCheck();
                }
            }

            // æ›´æ–°æç¤º
            setTimeout(() => {
                notification.textContent = 'âœ… æ•°æ®å·²åˆ·æ–°ï¼';
                setTimeout(() => {
                    notification.style.animation = 'slideOut 0.3s ease-out';
                    setTimeout(() => notification.remove(), 300);
                }, 1500);
            }, 500);
        }

        function dismissWelcomeGuide() {
            document.getElementById('welcomeGuide').style.display = 'none';
            localStorage.setItem('guide_dismissed', 'true');
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // ==================== é¡¹ç›®æ£€æŸ¥åŠŸèƒ½ ====================

        // è¿è¡Œé¡¹ç›®æ£€æŸ¥
        async function runProjectCheck() {
            const container = document.getElementById('checkResults');
            container.innerHTML = `
                <div style="text-align: center; padding: 40px;">
                    <div style="font-size: 40px; margin-bottom: 15px;">ğŸ”</div>
                    <p>æ­£åœ¨æ£€æŸ¥é¡¹ç›®æ–‡ä»¶...</p>
                </div>
            `;

            const results = {
                workflow: { name: 'å·¥ä½œæµç¨‹æ–‡æ¡£', status: 'unknown', items: [] },
                planning: { name: 'è§„åˆ’æ–‡ä»¶', status: 'unknown', items: [] },
                projects: { name: 'é¡¹ç›®é…ç½®', status: 'unknown', items: [] },
                scripts: { name: 'ç®¡ç†è„šæœ¬', status: 'unknown', items: [] }
            };

            // æ£€æŸ¥å·¥ä½œæµç¨‹æ–‡æ¡£
            try {
                const workflowFiles = [
                    { path: '~/WORKFLOW.md', desc: 'AI åŠ©æ‰‹å·¥ä½œæµç¨‹è§„èŒƒ' },
                    { path: '~/PROJECTS-CONFIG.md', desc: 'é¡¹ç›®é…ç½®æŒ‡å—' },
                    { path: '~/PROJECTS.md', desc: 'é¡¹ç›®ç«¯å£é…ç½®' },
                    { path: '~/PROJECT-CHECKLIST.md', desc: 'é¡¹ç›®é…ç½®æ¸…å•' }
                ];

                for (const file of workflowFiles) {
                    results.workflow.items.push({
                        file: file.path,
                        desc: file.desc,
                        exists: await checkFileExists(file.path)
                    });
                }
                results.workflow.status = results.workflow.items.every(i => i.exists) ? 'ok' : 'warning';
            } catch (e) {
                results.workflow.status = 'error';
            }

            // æ£€æŸ¥è§„åˆ’æ–‡ä»¶
            try {
                const planningFiles = [
                    { path: '~/task_plan.md', desc: 'ä»»åŠ¡è®¡åˆ’' },
                    { path: '~/findings.md', desc: 'ç ”ç©¶å‘ç°' },
                    { path: '~/progress.md', desc: 'è¿›åº¦æ—¥å¿—' }
                ];

                for (const file of planningFiles) {
                    results.planning.items.push({
                        file: file.path,
                        desc: file.desc,
                        exists: await checkFileExists(file.path)
                    });
                }
                results.planning.status = results.planning.items.every(i => i.exists) ? 'ok' : 'warning';
            } catch (e) {
                results.planning.status = 'error';
            }

            // æ£€æŸ¥ç®¡ç†è„šæœ¬
            try {
                const scriptFiles = [
                    { path: '~/projects.sh', desc: 'ç»Ÿä¸€å¯åŠ¨è„šæœ¬' },
                    { path: '~/test-projects.sh', desc: 'è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬' },
                    { path: '~/QUICKSTART.sh', desc: 'å¿«é€Ÿå¯åŠ¨åˆ«å' }
                ];

                for (const file of scriptFiles) {
                    results.scripts.items.push({
                        file: file.path,
                        desc: file.desc,
                        exists: await checkFileExists(file.path)
                    });
                }
                results.scripts.status = results.scripts.items.every(i => i.exists) ? 'ok' : 'warning';
            } catch (e) {
                results.scripts.status = 'error';
            }

            // æ£€æŸ¥é¡¹ç›®ç›®å½•
            try {
                const projectDirs = [
                    { path: '~/Documents/my_project/aisaasvideo', name: 'VideoFly', port: 3000 },
                    { path: '~/Documents/my_project/Chiengmai', name: 'Chiengmai', port: 4000 },
                    { path: '~/Documents/my_project/clawdbot-railway-template', name: 'clawdbot', port: 8080 }
                ];

                for (const proj of projectDirs) {
                    results.projects.items.push({
                        name: proj.name,
                        path: proj.path,
                        port: proj.port,
                        exists: await checkFileExists(proj.path)
                    });
                }
                results.projects.status = results.projects.items.every(i => i.exists) ? 'ok' : 'warning';
            } catch (e) {
                results.projects.status = 'error';
            }

            // æ¸²æŸ“ç»“æœ
            renderCheckResults(results);
        }

        // æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼ˆæ¨¡æ‹Ÿï¼‰
        async function checkFileExists(path) {
            // æ³¨æ„ï¼šæµè§ˆå™¨æ— æ³•ç›´æ¥è®¿é—®æ–‡ä»¶ç³»ç»Ÿ
            // è¿™é‡Œè¿”å›ä¸€ä¸ªæ¨¡æ‹Ÿç»“æœï¼Œå®é™…ä½¿ç”¨æ—¶éœ€è¦åç«¯æ”¯æŒ
            return new Promise(resolve => {
                // åŸºäºæ–‡ä»¶åè¿”å›æ¨¡æ‹Ÿç»“æœ
                const knownFiles = [
                    '~/WORKFLOW.md',
                    '~/PROJECTS-CONFIG.md',
                    '~/PROJECTS.md',
                    '~/PROJECT-CHECKLIST.md',
                    '~/task_plan.md',
                    '~/findings.md',
                    '~/progress.md',
                    '~/projects.sh',
                    '~/test-projects.sh',
                    '~/QUICKSTART.sh',
                    '~/Documents/my_project/aisaasvideo',
                    '~/Documents/my_project/Chiengmai',
                    '~/Documents/my_project/clawdbot-railway-template'
                ];
                setTimeout(() => {
                    resolve(knownFiles.includes(path));
                }, 100);
            });
        }

        // æ¸²æŸ“æ£€æŸ¥ç»“æœ
        function renderCheckResults(results) {
            const container = document.getElementById('checkResults');

            const statusIcons = {
                ok: 'âœ…',
                warning: 'âš ï¸',
                error: 'âŒ',
                unknown: 'â“'
            };

            const statusColors = {
                ok: '#10b981',
                warning: '#f59e0b',
                error: '#ef4444',
                unknown: '#6b7280'
            };

            let html = '<div style="display: flex; flex-direction: column; gap: 20px;">';

            // å·¥ä½œæµç¨‹æ–‡æ¡£
            html += renderCheckSection('workflow', results.workflow, statusIcons, statusColors);

            // è§„åˆ’æ–‡ä»¶
            html += renderCheckSection('planning', results.planning, statusIcons, statusColors);

            // é¡¹ç›®ç›®å½•
            html += renderCheckSection('projects', results.projects, statusIcons, statusColors);

            // ç®¡ç†è„šæœ¬
            html += renderCheckSection('scripts', results.scripts, statusIcons, statusColors);

            html += '</div>';

            // æ·»åŠ è¯´æ˜
            html += `
                <div style="margin-top: 30px; padding: 15px; background: #f0f9ff; border-radius: 8px; border-left: 4px solid #3b82f6;">
                    <p style="margin: 0; font-size: 13px; color: #64748b;">
                        ğŸ’¡ <strong>æç¤ºï¼š</strong>æ­¤æ£€æŸ¥åŸºäºå·²çŸ¥æ–‡ä»¶åˆ—è¡¨ã€‚è¦ä½¿ AI åŠ©æ‰‹æ¯æ¬¡æ‰§è¡Œä»»åŠ¡å‰è‡ªåŠ¨æ£€æŸ¥ï¼Œ
                        è¯·åœ¨ ~/WORKFLOW.md ä¸­å®šä¹‰å·¥ä½œæµç¨‹è§„èŒƒã€‚
                    </p>
                </div>
            `;

            container.innerHTML = html;
        }

        // æ¸²æŸ“æ£€æŸ¥éƒ¨åˆ†
        function renderCheckSection(key, data, statusIcons, statusColors) {
            const icon = statusIcons[data.status] || statusIcons.unknown;
            const color = statusColors[data.status] || statusColors.unknown;

            let html = `
                <div style="background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                    <div style="padding: 15px 20px; background: linear-gradient(135deg, ${color}15, ${color}08); border-bottom: 1px solid ${color}20; display: flex; align-items: center; gap: 10px;">
                        <span style="font-size: 20px;">${icon}</span>
                        <span style="font-weight: 600; color: ${color};">${data.name}</span>
                        <span style="margin-left: auto; font-size: 12px; color: #64748b;">
                            ${data.items.filter(i => i.exists || i.exists === undefined).length}/${data.items.length} å­˜åœ¨
                        </span>
                    </div>
                    <div style="padding: 15px 20px;">
            `;

            if (key === 'projects') {
                // é¡¹ç›®ç›®å½•æ ¼å¼
                data.items.forEach(item => {
                    const exists = item.exists;
                    html += `
                        <div style="padding: 10px; margin-bottom: 8px; background: ${exists ? '#f0fdf4' : '#fef2f2'}; border-radius: 6px; border-left: 3px solid ${exists ? '#22c55e' : '#ef4444'}; display: flex; align-items: center; gap: 10px;">
                            <span style="font-size: 16px;">${exists ? 'âœ…' : 'âŒ'}</span>
                            <div style="flex: 1;">
                                <div style="font-weight: 500; color: ${exists ? '#166534' : '#991b1b'};">${item.name}</div>
                                <div style="font-size: 12px; color: #64748b;">${item.path} Â· ç«¯å£ ${item.port}</div>
                            </div>
                        </div>
                    `;
                });
            } else {
                // æ–‡ä»¶æ ¼å¼
                data.items.forEach(item => {
                    const exists = item.exists;
                    html += `
                        <div style="padding: 10px; margin-bottom: 8px; background: ${exists ? '#f0fdf4' : '#fef2f2'}; border-radius: 6px; border-left: 3px solid ${exists ? '#22c55e' : '#ef4444'}; display: flex; align-items: center; gap: 10px;">
                            <span style="font-size: 16px;">${exists ? 'âœ…' : 'âŒ'}</span>
                            <div style="flex: 1;">
                                <div style="font-weight: 500; color: ${exists ? '#166534' : '#991b1b'};">${item.desc}</div>
                                <div style="font-size: 12px; color: #64748b;">${item.file}</div>
                            </div>
                            ${exists ? `<a href="#" onclick="event.preventDefault(); window.open('file://${item.file.replace('~', '/Users/yuzhoudeshengyin')}')" style="padding: 5px 12px; background: #22c55e; color: white; border-radius: 4px; font-size: 12px; text-decoration: none;">æŸ¥çœ‹</a>` : ''}
                        </div>
                    `;
                });
            }

            html += `
                    </div>
                </div>
            `;

            return html;
        }
    </script>
</body>
</html>
